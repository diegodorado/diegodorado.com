{"version":3,"sources":["webpack:///./src/layouts/fmtribe.js","webpack:///./src/pages/labs/fmtribe.js"],"names":["FMTRIBELayout","render","children","this","props","id","bodyAttributes","class","React","Component","FMTribeIndex","onChangeClientState","newState","addedTags","scriptTags","onload","handleOnLoad","Dos","window","refs","canvas","onprogress","stage","total","loaded","log","msg","wdosboxUrl","ready","fs","main","extract","then","setState","onStartClick","e","ci","started","onReturnClick","exit","state","tab","componentDidMount","componentWillUnmount","console","location","script","className","onClick","title","swaps","ref","href","target","rel","role","aria-hidden"],"mappings":"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","file":"component---src-pages-labs-fmtribe-js-a29aea5a480c56563bef.js","sourcesContent":["import React from \"react\"\nimport Helmet from \"react-helmet\"\nimport \"../components/i18n\"\n\n\nclass FMTRIBELayout extends React.Component {\n\n  render() {\n    const { children } = this.props\n    return (\n      <div id=\"app\">\n        <Helmet bodyAttributes={{class:'dark fmtribe'}} />\n        <main>{children}</main>\n      </div>\n    )\n  }\n}\n\nexport default FMTRIBELayout\n","import React from \"react\"\nimport Layout from \"../../layouts/fmtribe\"\nimport SEO from \"../../components/seo\"\nimport Helmet from \"react-helmet\"\nimport Brand from \"../../components/header/brand\"\nimport { FaTimesCircle,\n        } from 'react-icons/fa'\n\n\nclass FMTribeIndex extends React.Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      tab: 0,\n      loaded: false,\n      started: false,\n    }\n  }\n\n  componentDidMount(){\n  }\n\n\n  componentWillUnmount(){\n    console.log('unmount')\n    if(this.ci){\n      console.log('exit')\n      this.ci.exit()\n    }\n  }\n\n  onChangeClientState = (newState, addedTags) => {\n    if (addedTags.scriptTags) {\n        const scriptTag = addedTags.scriptTags[0];\n        scriptTag.onload = this.handleOnLoad;\n    }\n  }\n\n  handleOnLoad = () => {\n    const Dos = window.Dos\n    const options = {\n      onprogress: (stage, total, loaded) => {},\n      log: (msg) => {},\n      wdosboxUrl: '/fmtribe/wdosbox.js'\n    }\n    Dos(this.refs.canvas, options).ready((fs, main) => {\n      fs.extract('/fmtribe/fmtribe.zip').then(() => {\n        this.main = main\n        this.setState({loaded:true})\n      })\n    })\n  }\n\n  onStartClick = (e) => {\n    this.main([\"-c\", \"FMTRIBE.EXE\"]).then((ci) => {\n      this.ci = ci\n    })\n    this.setState({started: true})\n    //document.title = \"FMTRIBE by @munshkr\"\n  }\n\n  onReturnClick = (e) => {\n    this.ci.exit()\n    this.handleOnLoad()\n    this.setState({loaded: false, started: false})\n  }\n\n\n  render() {\n    return (\n      <Layout location={this.props.location} >\n        <Helmet onChangeClientState={this.onChangeClientState} script={[{\"src\": \"/fmtribe/js-dos.js\", \"type\": \"text/javascript\"}]} />\n        {this.state.started && <FaTimesCircle className=\"return\" onClick={this.onReturnClick}/>}\n        {!this.state.started && <header>\n          <Brand title=\"fm tribe\" swaps={[['f','F'],['m','w'],['i','1'],['e','3'],['b','B']]}/>\n        </header>}\n        <SEO title=\"fm tribe by @munshkr\" />\n        <div className={`${this.state.started? 'loaded':''} canvas-wrapper`}>\n          <canvas ref=\"canvas\"></canvas>\n        </div>\n\n        {!this.state.started && <div id=\"info\" className=\"usage\">\n          <p>FMTribe by is an OPL3 synth/drum machine/thingie focused on live jamming for DOS.\n          <br/>\n          Developed by <a href=\"https://github.com/munshkr\" target=\"_blank\" rel=\"noopener noreferrer\">munshkr</a> and brought to the browser thanks to <a href=\"https://js-dos.com/\" target=\"_blank\" rel=\"noopener noreferrer\">js-dos</a>.\n          Checkout <a href=\"https://github.com/munshkr/fmtribe\" target=\"_blank\" rel=\"noopener noreferrer\">fmtribe sources</a>.</p>\n          <nav>\n            <span role=\"link\" aria-hidden=\"true\" onClick={()=> this.setState({tab:0})} >Usage</span>\n            <span role=\"link\" aria-hidden=\"true\" onClick={()=> this.setState({tab:1})} >Step Sequencer</span>\n            <span role=\"link\" aria-hidden=\"true\" onClick={()=> this.setState({tab:2})} >Instrument Editor</span>\n          </nav>\n          {(this.state.tab===0) && <div>\n            <ul>\n              <li><code>Esc</code>: Exit</li>\n              <li><code>F5</code>: Play / pause</li>\n              <li><code>F7</code>: Stop after bar (2 times, stop immeadiately)</li>\n              <li><code>F9</code>: Tap tempo</li>\n              <li><code>Shift</code> + <code>F9</code>: Toggle metronome</li>\n              <li><code>F10</code>: Toggle \"follow cursor\"</li>\n              <li><code>Left</code>: Move to previous frame</li>\n              <li><code>Right</code>: Move to next frame</li>\n              <li><code>Up</code>: Move to previous channel</li>\n              <li><code>Down</code>: Move to next channel</li>\n              <li><code>Del</code>: Clear pattern for current channel</li>\n              <li><code>Ctrl</code> + <code>Del</code>: Clear pattern for all channels</li>\n              <li><code>Tab</code>: Switch instrument editor for the current channel</li>\n              <li><code>M</code>: Toggle \"apply step changes to all frames\"</li>\n              <li><code>P</code>: Toggle \"play channel instrument\"</li>\n              <li><code>Z</code>: Toggle \"record steps\"</li>\n              <li><code>Alt</code> + Number: Mute/unmute channel</li>\n            </ul>\n          </div>}\n          {(this.state.tab===1) && <div>\n            <p>To toggle a step in the pattern of the 16-step sequencer, use the keys:</p>\n            <pre>\n              <code>\n              {`Q W E R T Y U I\\nA S D F G H J K`}\n              </code>\n            </pre>\n            <p>To select one of the eight channels, use keys 1 through 8.\n              You can mute a channel anytime using <code>Alt</code> + NumberKey.</p>\n            <p>Press <code>Alt</code> + StepKey to define microsteps (upto 3 for now).</p>\n          </div>}\n          {(this.state.tab===2) && <div>\n            <p>To customize the parameters of an instrument, press the Tab key, select a field\n              and change its value. The parameters will update automatically if the step\n              sequencer is playing.</p>\n            <ul>\n              <li><code>Left</code>/<code>Right</code>: Increase/decrease value for the current field</li>\n              <li><code>Up</code>/<code>Down</code>: Move between parameter fields</li>\n            </ul>\n            <p>Also, you can still change channels with the numbers from the instrument\n              editor.</p>\n            <p>To change the base note of the instrument, use the keys:</p>\n            <pre>\n              <code>\n              {`W   E       T   Y   U \\nA   S   D   F   G   H   J`}\n              </code>\n            </pre>\n            <p>as in a keyboard of one octave. To change the base octave, use     <code>PageUp</code>/<code>PageDown</code>.</p>\n          </div>}\n          {this.state.loaded && <div className=\"start\">\n            <button onClick={this.onStartClick}>Start!</button>\n          </div>}\n        </div>}\n\n\n      </Layout>\n    )\n  }\n}\n\nexport default FMTribeIndex\n"],"sourceRoot":""}