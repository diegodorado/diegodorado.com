(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{"/8Fb":function(t,e,n){var r=n("XKFU"),a=n("UExd")(!0);r(r.S,"Object",{entries:function(t){return a(t)}})},"1Gk3":function(t,e){t.exports={_isSpecialKey:function(t){return 1===this._state.rows&&this._specialKeyMap[t]},_specialKey:function(t){"octave"===this._specialKeyMap[t].type&&this._state.octaveControls?this._state.octave+=this._specialKeyMap[t].value:"velocity"===this._specialKeyMap[t].type&&this._state.velocityControls&&(this._state.velocity=this._specialKeyMap[t].value)},_specialKeyMap:{90:{type:"octave",value:-1},88:{type:"octave",value:1},49:{type:"velocity",value:1},50:{type:"velocity",value:14},51:{type:"velocity",value:28},52:{type:"velocity",value:42},53:{type:"velocity",value:56},54:{type:"velocity",value:70},55:{type:"velocity",value:84},56:{type:"velocity",value:98},57:{type:"velocity",value:112},48:{type:"velocity",value:127}}}},"6eW1":function(t,e,n){n("bWfx"),n("8+KV"),n("V+eJ"),n("rGqo"),n("yt8O"),n("Btvt"),t.exports={_addKey:function(t){if(this._isNote(t.keyCode)&&!this._isPressed(t.keyCode)){var e=this._makeNote(t.keyCode);this._state.keys=(this._state.keys||[]).concat(e),this._update()}else this._isSpecialKey(t.keyCode)&&this._specialKey(t.keyCode)},_removeKey:function(t){if(this._isPressed(t.keyCode)){for(var e,n=0;n<this._state.keys.length;n++)if(this._state.keys[n].keyCode===t.keyCode){e=this._state.keys[n];break}this._state.keys.splice(this._state.keys.indexOf(e),1),this._update()}},_isPressed:function(t){if(!this._state.keys||!this._state.keys.length)return!1;for(var e=0;e<this._state.keys.length;e++)if(this._state.keys[e].keyCode===t)return!0;return!1},_makeNote:function(t){return{keyCode:t,note:this._map(t),frequency:this._toFrequency(this._map(t)),velocity:this._state.velocity}},clear:function(){var t=this;t._state.buffer.forEach((function(e){e.velocity=0,t._trigger("up",e)})),t._state.keys=[],t._state.buffer=[]},_update:function(){var t=this._state.buffer;this._prioritize(),this._diff(t)},_diff:function(t){var e=this,n=t.map((function(t){return t.keyCode})),r=e._state.buffer.map((function(t){return t.keyCode})),a=[];n.forEach((function(t){-1===r.indexOf(t)&&a.push(t)}));var o=[];r.forEach((function(t){-1===n.indexOf(t)&&o.push(t)})),o.forEach((function(t){for(var n=0;n<e._state.buffer.length;n++)if(e._state.buffer[n].keyCode===t){e._trigger("down",e._state.buffer[n]);break}})),a.forEach((function(n){for(var r=0;r<t.length;r++)if(t[r].keyCode===n){t[r].velocity=0,e._trigger("up",t[r]);break}}))}}},"7DDg":function(t,e,n){"use strict";if(n("nh4g")){var r=n("LQAc"),a=n("dyZX"),o=n("eeVq"),i=n("XKFU"),s=n("D4iV"),c=n("7Qtz"),u=n("m0Pp"),l=n("9gX7"),f=n("RjD/"),h=n("Mukb"),p=n("3Lyj"),d=n("RYi7"),v=n("ne8i"),m=n("Cfrj"),y=n("d/Gc"),g=n("apmT"),_=n("aagx"),w=n("I8a+"),E=n("0/R4"),k=n("S/j/"),b=n("M6Qj"),x=n("Kuth"),C=n("OP3Y"),S=n("kJMx").f,O=n("J+6e"),P=n("ylqs"),N=n("K0xU"),I=n("CkkT"),M=n("w2a5"),A=n("69bn"),D=n("yt8O"),L=n("hPIQ"),j=n("XMVh"),V=n("elZq"),F=n("Nr18"),K=n("upKx"),T=n("hswa"),U=n("EemH"),R=T.f,B=U.f,q=a.RangeError,W=a.TypeError,z=a.Uint8Array,G=Array.prototype,X=c.ArrayBuffer,H=c.DataView,J=I(0),Y=I(2),Q=I(3),Z=I(4),$=I(5),tt=I(6),et=M(!0),nt=M(!1),rt=D.values,at=D.keys,ot=D.entries,it=G.lastIndexOf,st=G.reduce,ct=G.reduceRight,ut=G.join,lt=G.sort,ft=G.slice,ht=G.toString,pt=G.toLocaleString,dt=N("iterator"),vt=N("toStringTag"),mt=P("typed_constructor"),yt=P("def_constructor"),gt=s.CONSTR,_t=s.TYPED,wt=s.VIEW,Et=I(1,(function(t,e){return St(A(t,t[yt]),e)})),kt=o((function(){return 1===new z(new Uint16Array([1]).buffer)[0]})),bt=!!z&&!!z.prototype.set&&o((function(){new z(1).set({})})),xt=function(t,e){var n=d(t);if(n<0||n%e)throw q("Wrong offset!");return n},Ct=function(t){if(E(t)&&_t in t)return t;throw W(t+" is not a typed array!")},St=function(t,e){if(!(E(t)&&mt in t))throw W("It is not a typed array constructor!");return new t(e)},Ot=function(t,e){return Pt(A(t,t[yt]),e)},Pt=function(t,e){for(var n=0,r=e.length,a=St(t,r);r>n;)a[n]=e[n++];return a},Nt=function(t,e,n){R(t,e,{get:function(){return this._d[n]}})},It=function(t){var e,n,r,a,o,i,s=k(t),c=arguments.length,l=c>1?arguments[1]:void 0,f=void 0!==l,h=O(s);if(null!=h&&!b(h)){for(i=h.call(s),r=[],e=0;!(o=i.next()).done;e++)r.push(o.value);s=r}for(f&&c>2&&(l=u(l,arguments[2],2)),e=0,n=v(s.length),a=St(this,n);n>e;e++)a[e]=f?l(s[e],e):s[e];return a},Mt=function(){for(var t=0,e=arguments.length,n=St(this,e);e>t;)n[t]=arguments[t++];return n},At=!!z&&o((function(){pt.call(new z(1))})),Dt=function(){return pt.apply(At?ft.call(Ct(this)):Ct(this),arguments)},Lt={copyWithin:function(t,e){return K.call(Ct(this),t,e,arguments.length>2?arguments[2]:void 0)},every:function(t){return Z(Ct(this),t,arguments.length>1?arguments[1]:void 0)},fill:function(t){return F.apply(Ct(this),arguments)},filter:function(t){return Ot(this,Y(Ct(this),t,arguments.length>1?arguments[1]:void 0))},find:function(t){return $(Ct(this),t,arguments.length>1?arguments[1]:void 0)},findIndex:function(t){return tt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},forEach:function(t){J(Ct(this),t,arguments.length>1?arguments[1]:void 0)},indexOf:function(t){return nt(Ct(this),t,arguments.length>1?arguments[1]:void 0)},includes:function(t){return et(Ct(this),t,arguments.length>1?arguments[1]:void 0)},join:function(t){return ut.apply(Ct(this),arguments)},lastIndexOf:function(t){return it.apply(Ct(this),arguments)},map:function(t){return Et(Ct(this),t,arguments.length>1?arguments[1]:void 0)},reduce:function(t){return st.apply(Ct(this),arguments)},reduceRight:function(t){return ct.apply(Ct(this),arguments)},reverse:function(){for(var t,e=Ct(this).length,n=Math.floor(e/2),r=0;r<n;)t=this[r],this[r++]=this[--e],this[e]=t;return this},some:function(t){return Q(Ct(this),t,arguments.length>1?arguments[1]:void 0)},sort:function(t){return lt.call(Ct(this),t)},subarray:function(t,e){var n=Ct(this),r=n.length,a=y(t,r);return new(A(n,n[yt]))(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,v((void 0===e?r:y(e,r))-a))}},jt=function(t,e){return Ot(this,ft.call(Ct(this),t,e))},Vt=function(t){Ct(this);var e=xt(arguments[1],1),n=this.length,r=k(t),a=v(r.length),o=0;if(a+e>n)throw q("Wrong length!");for(;o<a;)this[e+o]=r[o++]},Ft={entries:function(){return ot.call(Ct(this))},keys:function(){return at.call(Ct(this))},values:function(){return rt.call(Ct(this))}},Kt=function(t,e){return E(t)&&t[_t]&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Tt=function(t,e){return Kt(t,e=g(e,!0))?f(2,t[e]):B(t,e)},Ut=function(t,e,n){return!(Kt(t,e=g(e,!0))&&E(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?R(t,e,n):(t[e]=n.value,t)};gt||(U.f=Tt,T.f=Ut),i(i.S+i.F*!gt,"Object",{getOwnPropertyDescriptor:Tt,defineProperty:Ut}),o((function(){ht.call({})}))&&(ht=pt=function(){return ut.call(this)});var Rt=p({},Lt);p(Rt,Ft),h(Rt,dt,Ft.values),p(Rt,{slice:jt,set:Vt,constructor:function(){},toString:ht,toLocaleString:Dt}),Nt(Rt,"buffer","b"),Nt(Rt,"byteOffset","o"),Nt(Rt,"byteLength","l"),Nt(Rt,"length","e"),R(Rt,vt,{get:function(){return this[_t]}}),t.exports=function(t,e,n,c){var u=t+((c=!!c)?"Clamped":"")+"Array",f="get"+t,p="set"+t,d=a[u],y=d||{},g=d&&C(d),_=!d||!s.ABV,k={},b=d&&d.prototype,O=function(t,n){R(t,n,{get:function(){return function(t,n){var r=t._d;return r.v[f](n*e+r.o,kt)}(this,n)},set:function(t){return function(t,n,r){var a=t._d;c&&(r=(r=Math.round(r))<0?0:r>255?255:255&r),a.v[p](n*e+a.o,r,kt)}(this,n,t)},enumerable:!0})};_?(d=n((function(t,n,r,a){l(t,d,u,"_d");var o,i,s,c,f=0,p=0;if(E(n)){if(!(n instanceof X||"ArrayBuffer"==(c=w(n))||"SharedArrayBuffer"==c))return _t in n?Pt(d,n):It.call(d,n);o=n,p=xt(r,e);var y=n.byteLength;if(void 0===a){if(y%e)throw q("Wrong length!");if((i=y-p)<0)throw q("Wrong length!")}else if((i=v(a)*e)+p>y)throw q("Wrong length!");s=i/e}else s=m(n),o=new X(i=s*e);for(h(t,"_d",{b:o,o:p,l:i,e:s,v:new H(o)});f<s;)O(t,f++)})),b=d.prototype=x(Rt),h(b,"constructor",d)):o((function(){d(1)}))&&o((function(){new d(-1)}))&&j((function(t){new d,new d(null),new d(1.5),new d(t)}),!0)||(d=n((function(t,n,r,a){var o;return l(t,d,u),E(n)?n instanceof X||"ArrayBuffer"==(o=w(n))||"SharedArrayBuffer"==o?void 0!==a?new y(n,xt(r,e),a):void 0!==r?new y(n,xt(r,e)):new y(n):_t in n?Pt(d,n):It.call(d,n):new y(m(n))})),J(g!==Function.prototype?S(y).concat(S(g)):S(y),(function(t){t in d||h(d,t,y[t])})),d.prototype=b,r||(b.constructor=d));var P=b[dt],N=!!P&&("values"==P.name||null==P.name),I=Ft.values;h(d,mt,!0),h(b,_t,u),h(b,wt,!0),h(b,yt,d),(c?new d(1)[vt]==u:vt in b)||R(b,vt,{get:function(){return u}}),k[u]=d,i(i.G+i.W+i.F*(d!=y),k),i(i.S,u,{BYTES_PER_ELEMENT:e}),i(i.S+i.F*o((function(){y.of.call(d,1)})),u,{from:It,of:Mt}),"BYTES_PER_ELEMENT"in b||h(b,"BYTES_PER_ELEMENT",e),i(i.P,u,Lt),V(u),i(i.P+i.F*bt,u,{set:Vt}),i(i.P+i.F*!N,u,Ft),r||b.toString==ht||(b.toString=ht),i(i.P+i.F*o((function(){new d(1).slice()})),u,{slice:jt}),i(i.P+i.F*(o((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!o((function(){b.toLocaleString.call([1,2])}))),u,{toLocaleString:Dt}),L[u]=N?P:I,r||N||h(b,dt,I)}}else t.exports=function(){}},"7Qtz":function(t,e,n){"use strict";var r=n("dyZX"),a=n("nh4g"),o=n("LQAc"),i=n("D4iV"),s=n("Mukb"),c=n("3Lyj"),u=n("eeVq"),l=n("9gX7"),f=n("RYi7"),h=n("ne8i"),p=n("Cfrj"),d=n("kJMx").f,v=n("hswa").f,m=n("Nr18"),y=n("fyDq"),g=r.ArrayBuffer,_=r.DataView,w=r.Math,E=r.RangeError,k=r.Infinity,b=g,x=w.abs,C=w.pow,S=w.floor,O=w.log,P=w.LN2,N=a?"_b":"buffer",I=a?"_l":"byteLength",M=a?"_o":"byteOffset";function A(t,e,n){var r,a,o,i=new Array(n),s=8*n-e-1,c=(1<<s)-1,u=c>>1,l=23===e?C(2,-24)-C(2,-77):0,f=0,h=t<0||0===t&&1/t<0?1:0;for((t=x(t))!=t||t===k?(a=t!=t?1:0,r=c):(r=S(O(t)/P),t*(o=C(2,-r))<1&&(r--,o*=2),(t+=r+u>=1?l/o:l*C(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(a=0,r=c):r+u>=1?(a=(t*o-1)*C(2,e),r+=u):(a=t*C(2,u-1)*C(2,e),r=0));e>=8;i[f++]=255&a,a/=256,e-=8);for(r=r<<e|a,s+=e;s>0;i[f++]=255&r,r/=256,s-=8);return i[--f]|=128*h,i}function D(t,e,n){var r,a=8*n-e-1,o=(1<<a)-1,i=o>>1,s=a-7,c=n-1,u=t[c--],l=127&u;for(u>>=7;s>0;l=256*l+t[c],c--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;s>0;r=256*r+t[c],c--,s-=8);if(0===l)l=1-i;else{if(l===o)return r?NaN:u?-k:k;r+=C(2,e),l-=i}return(u?-1:1)*r*C(2,l-e)}function L(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function j(t){return[255&t]}function V(t){return[255&t,t>>8&255]}function F(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function K(t){return A(t,52,8)}function T(t){return A(t,23,4)}function U(t,e,n){v(t.prototype,e,{get:function(){return this[n]}})}function R(t,e,n,r){var a=p(+n);if(a+e>t[I])throw E("Wrong index!");var o=t[N]._b,i=a+t[M],s=o.slice(i,i+e);return r?s:s.reverse()}function B(t,e,n,r,a,o){var i=p(+n);if(i+e>t[I])throw E("Wrong index!");for(var s=t[N]._b,c=i+t[M],u=r(+a),l=0;l<e;l++)s[c+l]=u[o?l:e-l-1]}if(i.ABV){if(!u((function(){g(1)}))||!u((function(){new g(-1)}))||u((function(){return new g,new g(1.5),new g(NaN),"ArrayBuffer"!=g.name}))){for(var q,W=(g=function(t){return l(this,g),new b(p(t))}).prototype=b.prototype,z=d(b),G=0;z.length>G;)(q=z[G++])in g||s(g,q,b[q]);o||(W.constructor=g)}var X=new _(new g(2)),H=_.prototype.setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||c(_.prototype,{setInt8:function(t,e){H.call(this,t,e<<24>>24)},setUint8:function(t,e){H.call(this,t,e<<24>>24)}},!0)}else g=function(t){l(this,g,"ArrayBuffer");var e=p(t);this._b=m.call(new Array(e),0),this[I]=e},_=function(t,e,n){l(this,_,"DataView"),l(t,g,"DataView");var r=t[I],a=f(e);if(a<0||a>r)throw E("Wrong offset!");if(a+(n=void 0===n?r-a:h(n))>r)throw E("Wrong length!");this[N]=t,this[M]=a,this[I]=n},a&&(U(g,"byteLength","_l"),U(_,"buffer","_b"),U(_,"byteLength","_l"),U(_,"byteOffset","_o")),c(_.prototype,{getInt8:function(t){return R(this,1,t)[0]<<24>>24},getUint8:function(t){return R(this,1,t)[0]},getInt16:function(t){var e=R(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=R(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return L(R(this,4,t,arguments[1]))},getUint32:function(t){return L(R(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return D(R(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return D(R(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){B(this,1,t,j,e)},setUint8:function(t,e){B(this,1,t,j,e)},setInt16:function(t,e){B(this,2,t,V,e,arguments[2])},setUint16:function(t,e){B(this,2,t,V,e,arguments[2])},setInt32:function(t,e){B(this,4,t,F,e,arguments[2])},setUint32:function(t,e){B(this,4,t,F,e,arguments[2])},setFloat32:function(t,e){B(this,4,t,T,e,arguments[2])},setFloat64:function(t,e){B(this,8,t,K,e,arguments[2])}});y(g,"ArrayBuffer"),y(_,"DataView"),s(_.prototype,i.VIEW,!0),e.ArrayBuffer=g,e.DataView=_},Cfrj:function(t,e,n){var r=n("RYi7"),a=n("ne8i");t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=a(e);if(e!==n)throw RangeError("Wrong length!");return n}},D4iV:function(t,e,n){for(var r,a=n("dyZX"),o=n("Mukb"),i=n("ylqs"),s=i("typed_array"),c=i("view"),u=!(!a.ArrayBuffer||!a.DataView),l=u,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=a[h[f++]])?(o(r.prototype,s,!0),o(r.prototype,c,!0)):l=!1;t.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},NO8f:function(t,e,n){n("7DDg")("Uint8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},Nr18:function(t,e,n){"use strict";var r=n("S/j/"),a=n("d/Gc"),o=n("ne8i");t.exports=function(t){for(var e=r(this),n=o(e.length),i=arguments.length,s=a(i>1?arguments[1]:void 0,n),c=i>2?arguments[2]:void 0,u=void 0===c?n:a(c,n);u>s;)e[s++]=t;return e}},P34o:function(t,e,n){n("8+KV"),t.exports={down:function(t){this._listeners.down=(this._listeners.down||[]).concat(t)},up:function(t){this._listeners.up=(this._listeners.up||[]).concat(t)},_trigger:function(t){var e=this;if(e._listeners[t]&&e._listeners[t].length){var n=Array.prototype.slice.call(arguments);n.splice(0,1),e._listeners[t].forEach((function(t){t.apply(e,n)}))}},_bind:function(){var t=this;if("undefined"!=typeof window&&window.document){window.document.addEventListener("keydown",(function(e){t._addKey(e)})),window.document.addEventListener("keyup",(function(e){t._removeKey(e)}));var e=!0;setInterval((function(){window.document.hasFocus()!==e&&((e=!e)||t.clear())}),100)}}}},Rhw0:function(t,e){t.exports={_map:function(t){return this._keyMap[this._state.rows][t]+this._offset()},_offset:function(){return this._state.rootNote-this._keyMap[this._state.rows].root+12*this._state.octave},_isNote:function(t){return!!this._keyMap[this._state.rows][t]},_toFrequency:function(t){return 440*Math.pow(2,(t-69)/12)},_keyMap:{1:{root:60,65:60,87:61,83:62,69:63,68:64,70:65,84:66,71:67,89:68,72:69,85:70,74:71,75:72,79:73,76:74,80:75,186:76,222:77},2:{root:60,90:60,83:61,88:62,68:63,67:64,86:65,71:66,66:67,72:68,78:69,74:70,77:71,188:72,76:73,190:74,186:75,191:76,81:72,50:73,87:74,51:75,69:76,82:77,53:78,84:79,54:80,89:81,55:82,85:83,73:84,57:85,79:86,48:87,80:88,219:89,187:90,221:91}}}},Wjup:function(t,e,n){n("V+eJ"),n("xfY5"),n("Vd3H"),n("8+KV"),n("bWfx"),n("rGqo"),n("yt8O"),n("Btvt"),t.exports={_prioritize:function(){var t=this;t._state.keys.length?(t._state.polyphony>=t._state.keys.length?t._state.keys=t._state.keys.map((function(t){return t.isActive=!0,t})):(t._state.keys=t._state.keys.map((function(t){return t.isActive=!1,t})),t["_"+t._state.priority]()),t._state.buffer=[],t._state.keys.forEach((function(e){e.isActive&&t._state.buffer.push(e)}))):t._state.buffer=[]},_last:function(){for(var t=this._state.keys.length-this._state.polyphony;t<this._state.keys.length;t++)this._state.keys[t].isActive=!0},_first:function(){for(var t=0;t<this._state.polyphony;t++)this._state.keys[t].isActive=!0},_highest:function(){var t=this._state.keys.map((function(t){return t.note}));t.sort((function(t,e){return e===t?0:e<t?-1:1})),t.splice(this._state.polyphony,Number.MAX_VALUE),this._state.keys.forEach((function(e){-1!==t.indexOf(e.note)&&(e.isActive=!0)}))},_lowest:function(){var t=this._state.keys.map((function(t){return t.note}));t.sort((function(t,e){return t===e?0:t<e?-1:1})),t.splice(this._state.polyphony,Number.MAX_VALUE),this._state.keys.forEach((function(e){-1!==t.indexOf(e.note)&&(e.isActive=!0)}))}}},bHtr:function(t,e,n){var r=n("XKFU");r(r.P,"Array",{fill:n("Nr18")}),n("nGyu")("fill")},ls82:function(t,e,n){n("rGqo"),n("yt8O"),n("a1Th"),n("h7Nl"),n("VRzm"),n("Btvt"),n("/SS/"),n("f3/d"),n("8+KV"),n("hHhE"),n("rE2o"),n("ioFf");var r=function(t){"use strict";var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function s(t,e,n,r){var a=e&&e.prototype instanceof l?e:l,o=Object.create(a.prototype),i=new k(r||[]);return o._invoke=function(t,e,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return x()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=_(i,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=c(t,e,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(t,n,i),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=s;var u={};function l(){}function f(){}function h(){}var p={};p[a]=function(){return this};var d=Object.getPrototypeOf,v=d&&d(d(b([])));v&&v!==e&&n.call(v,a)&&(p=v);var m=h.prototype=l.prototype=Object.create(p);function y(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function g(t){var e;this._invoke=function(r,a){function o(){return new Promise((function(e,o){!function e(r,a,o,i){var s=c(t[r],t,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then((function(t){e("next",t,o,i)}),(function(t){e("throw",t,o,i)})):Promise.resolve(l).then((function(t){u.value=t,o(u)}),(function(t){return e("throw",t,o,i)}))}i(s.arg)}(r,a,e,o)}))}return e=e?e.then(o,o):o()}}function _(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=c(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var a=r.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function w(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function k(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(w,this),this.reset(!0)}function b(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return f.prototype=m.constructor=h,h.constructor=f,h[i]=f.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,i in t||(t[i]="GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},y(g.prototype),g.prototype[o]=function(){return this},t.AsyncIterator=g,t.async=function(e,n,r,a){var o=new g(s(e,n,r,a));return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},y(m),m[i]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=b,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return i.type="throw",i.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;E(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:b(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=r}catch(a){Function("r","regeneratorRuntime = r")(r)}},"m+DT":function(t,e,n){"use strict";n.r(e);var r=n("q1tI"),a=n.n(r),o=n("IQjg"),i=n("TJpk"),s=n.n(i);n("NBUx");var c=function(t){var e,n;function r(){return t.apply(this,arguments)||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){var t=this.props.children;return a.a.createElement("div",{id:"app"},a.a.createElement("header",null,a.a.createElement(s.a,{bodyAttributes:{class:"dark cv2612"}}),a.a.createElement(o.a,{title:"diego dorado"})),a.a.createElement("main",null,t))},r}(a.a.Component),u=n("vrFN"),l=(n("rE2o"),n("ioFf"),n("9VmF"),n("RW0V"),n("Vd3H"),n("KKXr"),n("Z2Ku"),n("L9s1"),n("rGqo"),n("yt8O"),n("Btvt"),n("/8Fb"),n("91GP"),["lfo","play-mode","cc-mode","x","y","z","vel-sensitivity","rgb-intensity"]),f=["ar","d1","sl","d2","rr","tl","mul","det","rs","am","al","fb","ams","fms","st","lfo"],h=function(){var t={},e=l,n=Array.isArray(e),r=0;for(e=n?e:e[Symbol.iterator]();;){var a;if(n){if(r>=e.length)break;a=e[r++]}else{if((r=e.next()).done)break;a=r.value}t[a]=0}t.voices=[];for(var o=0;o<6;o++)t.voices[o]=p();return t.name="empty",t},p=function(){for(var t={fms:0,fb:0,al:0,ams:0,st:3},e=0;e<4;e++)t["mul_"+e]=0,t["tl_"+e]=0,t["ar_"+e]=0,t["d1_"+e]=0,t["sl_"+e]=0,t["rr_"+e]=0,t["am_"+e]=0,t["rs_"+e]=0,t["det_"+e]=0,t["d2_"+e]=0;return t},d=function(){var t=p(),e=l,n=Array.isArray(e),r=0;for(e=n?e:e[Symbol.iterator]();;){var a;if(n){if(r>=e.length)break;a=e[r++]}else{if((r=e.next()).done)break;a=r.value}t[a]=0}return t},v=function(){var t=d();for(var e in t)t[e]=null;return t},m=function(t){for(var e=1,n=0,r=[["am","en"],["rs","st","ams"],["det","al","fb","fms","lfo"],["sl","rr","mul"],["ar","d2","d1"],[],["tl"]];n<r.length;n++){if(r[n].some((function(e){return t.startsWith(e)})))return e;e++}return 7};n("pIFo");var y=n("KVCq");var g=a.a.createContext(),_=(g.Consumer,function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).handleCC=function(t,e,r){var a=n.state.activeParameter;if(n.state.mapping[a]&&n.state.learning){var o=Object.assign({},n.state.mapping);o[a]!==e&&(o[a]=e,n.setState({mapping:o}),y.reactLocalStorage.setObject("mapping",o))}for(var i=0,s=Object.entries(n.state.mapping);i<s.length;i++){var c=s[i],u=c[0];if(c[1]===e){var l=m(u),f=128/Math.pow(2,l),h=Math.floor(r/f);n.updateParam(u,h)}}},n.toggleLearning=function(){n.setState({learning:!n.state.learning})},n.sendParameter=function(t,e){if(l.includes(t))console.log(t),n.patch[t]=e,"lfo"===t?n.state.midi.sendCC(0,1,16*(e+1)-1):"play-mode"===t?n.state.midi.sendCC(0,2,e):"vel-sensitivity"===t&&n.state.midi.sendCC(0,3,e);else{var r=t.split("_"),a=r[0],o=parseInt(r[1]);if(-1===f.indexOf(a))console.error("Unexpected param "+a+" in code "+t);else{var i=["ar","d1","sl","d2","rr","tl","mul","det","rs","am"].indexOf(a);if(-1!==i)for(var s=m(a),c=(e+1)*(128/Math.pow(2,s))-1,u=0;u<6;u++)n.state.midi.sendCC(u,20+10*o+i,c);var h=["al","fb","ams","fms","st","lfo"].indexOf(a);if(-1!==h)for(var p=m(a),d=(e+1)*(128/Math.pow(2,p))-1,v=0;v<6;v++)n.state.midi.sendCC(v,10+h,d);n.state.emulator.update(n.state.voice,t,e),n.patch.voices[n.state.voice][t]=e}}},n.sendVoice=function(t){var e=Object.keys(n.state.params).filter((function(e){return e.startsWith(t+"_")})).sort().map((function(t){return n.state.params[t]}));e.unshift(t),e.unshift(4),n.state.midi.sendSysexSet(e)},n.sendPatch=function(){for(var t=0;t<6;t++)for(var e=0,r=Object.entries(n.patch.voices[t]);e<r.length;e++){var a=r[e],o=a[0],i=a[1];n.state.emulator.update(t,o,i)}n.state.emulator.update(null,"lfo",n.patch.lfo)},n.setActiveParameter=function(t){n.setState({activeParameter:t})},n.updateParam=function(t,e){var r=Object.assign({},n.state.params);r[t]=e,n.setState({params:r})},n.loadPatch=function(t){n.patch=t,n.updateParamsFromVoice(t.voices[n.state.voice]),n.loadingPatch=!0},n.selectVoice=function(t){n.updateParamsFromVoice(n.patch.voices[t]),n.setState({voice:t}),n.loadingVoice=!0},n.updateParamsFromVoice=function(t){for(var e=Object.assign({},n.state.params),r=0,a=Object.entries(t);r<a.length;r++){var o=a[r],i=o[0],s=o[1];e[i]=s}n.setState({params:e})},n.patch=h(),n.state={midi:null,emulator:null,learning:!1,activeParameter:null,envelopes:{},mapping:v(),params:d(),voice:0,soundOn:!1,setActiveParameter:n.setActiveParameter,updateParam:n.updateParam,sendVoice:n.sendVoice,loadPatch:n.loadPatch,selectVoice:n.selectVoice,toggleLearning:n.toggleLearning,handleCC:n.handleCC},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){var t={};if(Object.keys(t).length>0){for(var e=Object.assign({},this.state.mapping),n=0,r=Object.entries(t);n<r.length;n++){var a=r[n],o=a[0],i=a[1];e[o]=i}this.setState({mapping:e})}},o.componentDidUpdate=function(t,e){if(this.loadingPatch)this.loadingPatch=!1,this.sendPatch(),this.updateEnvelopesIfChanged(this.state.params);else if(this.loadingVoice)this.loadingVoice=!1,this.updateEnvelopesIfChanged(this.state.params);else{if(e.params===this.state.params)return;var n=(f=e.params,h=this.state.params,Object.keys(h).reduce((function(t,e){var n;return f[e]===h[e]?t:Object.assign({},t,((n={})[e]=h[e],n))}),{})),r=Object.entries(n);if(r.length>0){var a=r,o=Array.isArray(a),i=0;for(a=o?a:a[Symbol.iterator]();;){var s;if(o){if(i>=a.length)break;s=a[i++]}else{if((i=a.next()).done)break;s=i.value}var c=s,u=c[0],l=c[1];this.sendParameter(u,l)}this.updateEnvelopesIfChanged(n)}}var f,h},o.updateEnvelopesIfChanged=function(t){var e=this,n=["ar","d1","sl","d2","rr","tl"],r=Object.keys(t).reduce((function(t,e){return n.some((function(t){return e.startsWith(t)}))&&t.push(e.split("").reverse()[0]),t}),[]).filter((function(t,e,n){return n.indexOf(t)===e}));if(r.length){var a=Object.assign({},this.state.envelopes);r.forEach((function(t){var r=n.reduce((function(n,r){return n[""+r]=e.state.params[r+"_"+t],n}),{});a[t]=function(t){var e=Math.round((31-t.ar)/31*100),n=Math.round(t.tl/127*100),r=Math.round(e+(31-t.d1)/31*100),a=Math.round(n+(100-n)*(t.sl/15)),o=Math.round(r+100);return[[0,100],[e,n],[r,a],[o,Math.round(a+(100-a)*(t.d2/31*.5))],[Math.round(o+(15-t.rr)/31*200),100]].map((function(t){return t.join(",")})).join(" ").replace(/NaN/g,"0")}(r)})),this.setState({envelopes:a})}},o.render=function(){return a.a.createElement(g.Provider,{value:this.state},this.props.children)},r}(a.a.Component)),w=(n("VRzm"),n("f3/d"),n("o0o1")),E=n.n(w),k=(n("ls82"),n("ma3e"));n("XfO3"),n("HEwt");function b(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,a)}function x(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){b(o,r,a,i,s,"next",t)}function s(t){b(o,r,a,i,s,"throw",t)}i(void 0)}))}}var C=function(t){var e=this;this.caller=null,this.ma=null,this.lastMsg=null,this.refresh=function(t){for(var n=Array.from(e.ma.inputs.values()),r=Array.from(e.ma.outputs.values()),a=0,o=n;a<o.length;a++){o[a].onmidimessage=e.onMIDIMessage}e.caller.onStateChange(n,r)},this.sendHandshake2=x(E.a.mark((function t(){var n;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[240,126,127,6,1,247],t.abrupt("return",e.sendSysex(n).then((function(t){return t})));case 2:case"end":return t.stop()}}),t)}))),this.sendHandshake=x(E.a.mark((function t(){var n,r;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[240,126,0,6,2,38,38,18,0,0,1,0,0,0,247],r=[240,126,127,6,1,247],t.abrupt("return",e.sendSysex(r).then((function(t){if(JSON.stringify(t)===JSON.stringify(n))return"CV2612 found!";throw new Error("Not a CV2612 found!")})));case 3:case"end":return t.stop()}}),t)}))),this.sysexPromisePending=!1,this.sysexPromiseResolve=null,this.sendSysex=function(){var t=x(E.a.mark((function t(n){var r,a;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.sysexPromisePending){t.next=2;break}throw new Error("A sysex message is pending");case 2:return 500,r=new Promise((function(t,n){var r=setTimeout((function(){clearTimeout(r),e.sysexPromisePending=!1,n("Timed out in 500ms.")}),500)})),a=new Promise((function(t,r){e.sendMidi(n),e.sysexPromisePending=!0,e.sysexPromiseResolve=t})),t.abrupt("return",Promise.race([a,r]));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.sendSysexSet=function(){var t=x(E.a.mark((function t(n){var r,a,o,i,s,c,u;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[240,65,38,18,18],a=0,o=n,i=Array.isArray(o),s=0,o=i?o:o[Symbol.iterator]();case 3:if(!i){t.next=9;break}if(!(s>=o.length)){t.next=6;break}return t.abrupt("break",18);case 6:c=o[s++],t.next=13;break;case 9:if(!(s=o.next()).done){t.next=12;break}return t.abrupt("break",18);case 12:c=s.value;case 13:u=c,r.push(u),a+=u;case 16:t.next=3;break;case 18:return r.push(127-a%127),r.push(247),t.abrupt("return",e.sendSysex(r));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.sendMidi=function(t){if(null!==e.ma){var n=e.ma.outputs.get(e.caller.state.midiOutId);n?n.send(t):console.log("no midi out")}},this.onCtrlMIDIMessage=function(t){if(t.target.id===e.caller.state.midiCtrlInId){var n=Array.from(t.data);if(JSON.stringify(e.lastMsg)!==JSON.stringify(n)){var r=240&n[0];if(176===r){var a=15&n[0],o=127&n[1],i=127&n[2];e.caller.onControlChange(a,o,i)}128!==r&&144!==r||(e.sendMidi(n),144===r?e.caller.onNoteOn(n[1],n[2]):e.caller.onNoteOff(n[1],n[2]))}else e.caller.onLoopBack()}},this.onMIDIMessage=function(t){if(t.target.id===e.caller.state.midiInId){var n=Array.from(t.data);JSON.stringify(e.lastMsg)!==JSON.stringify(n)?240===n[0]&&(e.sysexPromisePending=!1,e.sysexPromiseResolve(n)):e.caller.onLoopBack()}},this.caller=t,navigator.requestMIDIAccess({sysex:!0}).then((function(t){e.ma=t,t.onstatechange=e.refresh,e.refresh()}),(function(){return console.log("Could not access your MIDI devices.")}))};function S(t,e,n,r,a,o,i){try{var s=t[o](i),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(r,a)}var O=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).onChangeMidiIn=function(t){n.setState({midiInId:t.target.value})},n.onChangeMidiCtrlIn=function(t){n.setState({midiCtrlInId:t.target.value})},n.onChangeMidiOut=function(t){n.setState({midiOutId:t.target.value})},n.sendMidi=function(t){n.io.sendMidi(t)},n.sendCC=function(t,e,r){var a=[176|t,127&e,127&r];console.log(a),n.io.sendMidi(a)},n.onLearnClick=function(t){t.preventDefault(),n.context.toggleLearning()},n.onPanicClick=function(t){t.preventDefault(),n.sendMidi([255])},n.onClearClick=function(t){t.preventDefault(),n.sendSysexSet([6,4,17,0])},n.onToggleSoundClick=function(t){t.preventDefault(),n.context.toggleSound()},n.state={midiIns:[],midiOuts:[],connected:!1},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){this.io=new C(this),this.context.midi=this},o.onStateChange=function(t,e){var n=this,r={midiIns:t,midiOuts:e,connected:!1},a=function(e,a){var o=y.reactLocalStorage.get(e,"");""===o||a.map((function(t){return t.id})).includes(o)||(o=t[0].id),o!==n.state[e]&&(r[e]=o)};t.length&&(a("midiInId",t),a("midiCtrlInId",t)),e.length&&a("midiOutId",e),this.setState(r)},o.onLoopBack=function(){this.setMidiOut(""),console.error("Loopback prevented")},o.onNoteOn=function(t,e){this.context.emulator.noteOn(t)},o.onNoteOff=function(t,e){this.context.emulator.noteOff(t)},o.onControlChange=function(t,e,n){this.context.handleCC(t,e,n)},o.componentDidUpdate=function(t,e){var n,r=this,a=!1;["midiCtrlInId","midiInId","midiOutId"].forEach((function(t){e[t]!==r.state[t]&&(y.reactLocalStorage.set(t,r.state[t]),r.setState({connected:!1}),a=!0)})),a&&(n=E.a.mark((function t(){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.io.sendHandshake();case 3:r.setState({connected:!0}),t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0),r.setState({connected:!1});case 10:case"end":return t.stop()}}),t,null,[[0,6]])})),function(){var t=this,e=arguments;return new Promise((function(r,a){var o=n.apply(t,e);function i(t){S(o,r,a,i,s,"next",t)}function s(t){S(o,r,a,i,s,"throw",t)}i(void 0)}))})()},o.render=function(){return a.a.createElement("nav",{className:"midi "+(this.state.connected?"connected":"")},a.a.createElement("span",null,"Ctrl"),a.a.createElement("select",{className:"ctrl",value:this.state.midiCtrlInId,onBlur:this.onChangeMidiCtrlIn},a.a.createElement("option",{key:"",value:""},"Not Connected"),this.state.midiIns.map((function(t){return a.a.createElement("option",{key:t.id,value:t.id},t.name)}))),a.a.createElement("span",null,"In"),a.a.createElement("select",{className:"in",value:this.state.midiInId,onBlur:this.onChangeMidiIn},a.a.createElement("option",{key:"",value:""},"Not Connected"),this.state.midiIns.map((function(t){return a.a.createElement("option",{key:t.id,value:t.id},t.name)}))),a.a.createElement("span",null,"Out"),a.a.createElement("select",{className:"out",value:this.state.midiOutId,onBlur:this.onChangeMidiOut},a.a.createElement("option",{key:"",value:""},"Not Connected"),this.state.midiOuts.map((function(t){return a.a.createElement("option",{key:t.id,value:t.id},t.name)}))),a.a.createElement("a",{className:this.context.learning?"learning":"",href:"/",title:"Click to Learn",onClick:this.onLearnClick},a.a.createElement(k.r,null)),a.a.createElement("a",{href:"/",title:"Click if panic",onClick:this.onPanicClick},a.a.createElement(k.i,null)),a.a.createElement("a",{href:"/",title:"Click to clear midi mapping",onClick:this.onClearClick},a.a.createElement(k.v,null)))},r}(a.a.Component);O.contextType=g;var P=O,N=(n("NO8f"),n("bHtr"),n("zcix"));var I=new(n.n(N).a)({polyphony:1,rows:1,priority:"last",octave:2}),M=function(t){var e,n;function r(e){var n;(n=t.call(this,e)||this).audioCtx=null,n.tick=function(){n.stopAnimation||(n.drawScope(),n.drawSpectrum(),requestAnimationFrame(n.tick))},n.noteOn=function(t){var e=440*Math.pow(2,(t-69)/12);n.onKeyDown({note:t,frequency:e})},n.noteOff=function(t){n.onKeyUp({note:t})},n.onKeyDown=function(t){t.note<0||t.note>127||(n.context.midi.sendMidi([144,t.note,112]),n.ym2612Node&&(-1===n.notes.indexOf(t.note)&&n.notes.push(t.note),n.setFrequency(t.frequency),1===n.notes.length&&n.keyOn()))},n.onKeyUp=function(t){if(!(t.note<0||t.note>127)&&(n.context.midi.sendMidi([128,t.note,0]),n.ym2612Node)){for(var e=0;e<n.notes.length;e++)n.notes[e]===t.note&&n.notes.splice(e,1);0===n.notes.length&&n.keyOff()}},n.update=function(t,e,r){var a=e.split("_"),o=a[0],i=a[1];if("lfo"!==e){n.cache[t][e]=r;var s=256*Math.floor(t/3)+t%3,c=function(e,r,a){return((void 0===i?n.cache[t][e]:n.cache[t][e+"_"+i])&Math.pow(2,r)-1)<<a};if("det"===o||"mul"===o){var u=c("det",3,4)|c("mul",4,0);n.write(48+4*i+s,u)}else if("tl"===o){var l=c("tl",7,0);n.write(64+4*i+s,l)}else if("rs"===o||"ar"===o){var f=c("rs",2,6)|c("ar",5,0);n.write(80+4*i+s,f)}else if("am"===o||"d1"===o){var h=c("am",1,7)|c("d1",5,0);n.write(96+4*i+s,h)}else if("d2"===o){var p=c("d2",5,0);n.write(112+4*i+s,p)}else if("sl"===o||"rr"===o){var d=c("sl",4,4)|c("rr",4,0);n.write(128+4*i+s,d)}else if("al"===o||"fb"===o){var v=c("fb",3,3)|c("al",3,0);n.write(176+s,v)}else if("st"===o||"ams"===o||"fms"===o){var m=c("st",2,6)|c("ams",2,4)|c("fms",3,0);n.write(180+s,m)}}else{var y=(r>0&1)<<3|7&r;n.write(34,y)}},n.onToggleSoundClick=function(t){t.preventDefault(),"running"===n.audioCtx.state?n.audioCtx.suspend().then((function(){n.setState({soundOn:!1})})):"suspended"===n.audioCtx.state&&n.audioCtx.resume().then((function(){n.initialize()}))},n.state={soundOn:!1},n.fftSize=1024,n.cache=[];for(var r=0;r<6;r++)n.cache.push(p());return n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){this.audioCtx=new AudioContext,"running"===this.audioCtx.state&&this.initialize(),this.notes=[],this.context.emulator=this,I.down(this.onKeyDown),I.up(this.onKeyUp),this.scope=this.refs.scope.getContext("2d"),this.scope.fillStyle="rgba(0, 20, 0, 0.1)",this.scope.lineWidth=2,this.scope.strokeStyle="#509eec",this.spectrum=this.refs.spectrum.getContext("2d"),this.spectrum.fillStyle="rgba(0, 20, 0, 0.1)",this.spectrum.lineWidth=1,this.spectrum.strokeStyle="#509eec",this.stopAnimation=!1,this.timeData=new Uint8Array(this.fftSize).fill(128),this.freqData=new Uint8Array(this.fftSize),requestAnimationFrame(this.tick)},o.componentWillUnmount=function(){this.audioCtx.suspend(),I._listeners.down=[],I._listeners.up=[],this.stopAnimation=!0,this.timeData=null,this.freqData=null},o.drawScope=function(){var t=this.scope,e=t.canvas.width,n=t.canvas.height,r=this.fftSize,a=n/256;this.analyser&&this.analyser.getByteTimeDomainData(this.timeData),t.fillRect(0,0,e,n),t.beginPath();for(var o=this.timeData.reduce((function(t,e,n,a){return 0===t&&n>0&&n<r-10&&a[n-1]<128&&a[n+10]>128?n:t}),0),i=o;i<r&&i-o<e;i++)t.lineTo(i-o,n-this.timeData[i]*a);t.stroke()},o.drawSpectrum=function(){var t=this.spectrum,e=t.canvas.width,n=t.canvas.height,r=this.fftSize,a=n/256,o=e/r;this.analyser&&this.analyser.getByteFrequencyData(this.freqData),t.fillRect(0,0,e,n),t.beginPath();for(var i,s,c,u=1;u<r;u++){var l=(c=void 0,c=(u-(i=1))/((s=r-1)-i),i*Math.pow(s/i,c)),f=Math.floor(l),h=Math.ceil(l),p=this.freqData[f],d=p+(this.freqData[h]-p)*((l-f)/(h-f));t.lineTo(u*o,n-d*a)}t.stroke()},o.initialize=function(){var t=this;this.audioCtx.audioWorklet.addModule("/cv2612/ym2612-processor.js").then((function(){t.ym2612Node=new AudioWorkletNode(t.audioCtx,"ym2612-generator",{outputChannelCount:[2]}),t.ym2612Node.connect(t.audioCtx.destination),t.analyser=t.audioCtx.createAnalyser(),t.analyser.fftSize=t.fftSize,t.ym2612Node.connect(t.analyser),t.write(39,0),t.write(40,0)})),this.setState({soundOn:!0})},o.setFrequency=function(t){for(var e=4;t>=2048;)t/=2,e++;for(var n=parseInt(t),r=0;r<6;r++){var a=256*Math.floor(r/3)+r%3;this.write(164+a,n>>8&7|(7&e)<<3),this.write(160+a,255&n)}},o.keyOn=function(){for(var t=0;t<6;t++)this.write(40,4*Math.floor(t/3)+t%3+240)},o.keyOff=function(){for(var t=0;t<6;t++)this.write(40,4*Math.floor(t/3)+t%3+0)},o.write=function(t,e){this.ym2612Node&&this.ym2612Node.port.postMessage([t,e])},o.render=function(){return a.a.createElement("div",{className:"emulator"},a.a.createElement("nav",null,a.a.createElement("a",{href:"/",title:"Toggles Sound",onClick:this.onToggleSoundClick},this.state.soundOn?a.a.createElement(k.z,null):a.a.createElement(k.y,null))),a.a.createElement("canvas",{ref:"scope",width:200,height:60}),a.a.createElement("canvas",{ref:"spectrum",width:200,height:60}))},r}(a.a.Component);M.contextType=g;var A=M;n("sFw1");var D=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this).addDmpPatch=function(t,e){var r=function(t,e){if(9===e[0]&&1===e[1]&&0===e[2]||11===e[0]&&2===e[1]&&1===e[2]){var n=p();n.fms=e[3],n.fb=e[4],n.al=e[5],n.ams=e[6];for(var r=0;r<4;r++){var a=11*r+7;n["mul_"+r]=e[a+0],n["tl_"+r]=e[a+1],n["ar_"+r]=e[a+2],n["d1_"+r]=e[a+3],n["sl_"+r]=e[a+4],n["rr_"+r]=e[a+5],n["am_"+r]=e[a+6],n["rs_"+r]=e[a+7],n["det_"+r]=e[a+8],n["d2_"+r]=e[a+9]}return n}return null}(0,e);if(null!==r&&n.addPatch(t.replace(".dmp",""),[r]),n.state.patches.length>10){for(var a="Random "+Math.floor(1e3*Math.random()),o=[],i=0;i<6;i++){var s=Math.floor(Math.random()*n.state.patches.length),c=n.state.patches[s].voices[0];o.push(Object.assign({},c))}n.addPatch(a,o)}},n.addPatch=function(t,e){var r=h();r.name=t;for(var a=0;a<6;a++){var o=e[a%e.length];r.voices[a]=Object.assign({},o)}var i=n.state.patches;i.push(r),n.save(i)},n.onChangeHandler=function(t){var e=function(){if(a){if(o>=r.length)return"break";i=r[o++]}else{if((o=r.next()).done)return"break";i=o.value}var t=i,e=new FileReader;e.onload=function(){var r=new Int8Array(e.result);n.addDmpPatch(t.name,r)},e.readAsArrayBuffer(t)},r=t.target.files,a=Array.isArray(r),o=0;for(r=a?r:r[Symbol.iterator]();;){var i;if("break"===e())break}},n.onChange=function(t){n.setState({current:t.target.value}),t.target.blur()},n.onSave=function(t){if(t.preventDefault(),0!==n.state.patches.length){var e=n.state.patches;e[parseInt(n.state.current)].params=n.context.params,n.save(e)}},n.onCreate=function(t){t.preventDefault();var e=prompt("Name your patch");if(null!==e&&""!==e){var r=n.state.patches;r.push({name:e,params:n.context.params}),n.save(r)}},n.onDelete=function(t){if(t.preventDefault(),!(n.state.patches.length<=1)){var e=n.state.patches.filter((function(t,e){return e!==parseInt(n.state.current)}));n.save(e)}},n.onLoadDefaults=function(t){t.preventDefault(),n.loadDefaultPatches()},n.onLeftClick=function(t){t.preventDefault();var e=parseInt(n.state.current);e>0&&n.setState({current:e-1})},n.onRightClick=function(t){t.preventDefault();var e=parseInt(n.state.current);e<n.state.patches.length-1&&n.setState({current:e+1})},n.onUploadClick=function(t){t.preventDefault(),n.refs.file.click()},n.state={patches:[h()],current:0},n}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n;var o=r.prototype;return o.componentDidMount=function(){var t=[];0===t.length||0===Object.keys(t).length?this.loadDefaultPatches():this.setState({patches:t})},o.save=function(t){y.reactLocalStorage.setObject("patches",t),this.setState({patches:t})},o.loadDefaultPatches=function(){var t=this;this.save([]);var e=new XMLHttpRequest;e.onreadystatechange=function(n){if(4===e.readyState&&200===e.status){var r=function(){if(o){if(i>=a.length)return"break";s=a[i++]}else{if((i=a.next()).done)return"break";s=i.value}var e=s,n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=function(r){if(4===n.readyState&&200===n.status){var a=new Int8Array(n.response);t.addDmpPatch(e,a)}},n.open("GET",encodeURI("/cv2612/instruments/"+e)),n.send(null)},a=e.responseText.split(/\r?\n/).filter((function(t){return t.length>1})),o=Array.isArray(a),i=0;for(a=o?a:a[Symbol.iterator]();;){var s;if("break"===r())break}}},e.open("GET","/cv2612/instruments/index.txt"),e.send(null)},o.componentDidUpdate=function(t,e){if(e.current!==this.state.current){var n=parseInt(this.state.current),r=this.state.patches[n];r&&this.context.loadPatch(r)}if(e.patches.length!==this.state.patches.length){this.setState({current:0});var a=this.state.patches[0];a&&this.context.loadPatch(a)}},o.render=function(){return a.a.createElement("nav",null,a.a.createElement("a",{href:"/",title:"Previous Patch",onClick:this.onLeftClick},a.a.createElement(k.c,null)),a.a.createElement("select",{value:this.state.current,onBlur:this.onChange},this.state.patches.map((function(t,e){return a.a.createElement("option",{key:e,value:e},t.name)}))),a.a.createElement("a",{href:"/",title:"Next Patch",onClick:this.onRightClick},a.a.createElement(k.d,null)),a.a.createElement("a",{href:"/",title:"Save this Patch",onClick:this.onSave},a.a.createElement(k.p,null)),a.a.createElement("a",{href:"/",title:"Create new Patch",onClick:this.onCreate},a.a.createElement(k.n,null)),a.a.createElement("a",{href:"/",title:"Upload Patches",onClick:this.onUploadClick},a.a.createElement(k.w,null)),a.a.createElement("a",{href:"/",title:"Delete this Patch",onClick:this.onDelete},a.a.createElement(k.a,null)),a.a.createElement("a",{href:"/",title:"Load default Patches",onClick:this.onLoadDefaults},a.a.createElement(k.b,null)),a.a.createElement("input",{style:{display:"none"},ref:"file",type:"file",accept:".dmp",multiple:!0,onChange:this.onChangeHandler}))},r}(a.a.Component);D.contextType=g;var L=D,j=function(t){var e=Object(r.useContext)(g);return a.a.createElement("div",{className:"envelope"},a.a.createElement("svg",{height:"100",width:"400",viewBox:"0 0 400 100",xmlns:"http://www.w3.org/2000/svg"},a.a.createElement("polyline",{points:e.envelopes[""+t.op]})))},V=function(t){var e=Object(r.useContext)(g),n=m(t.name),o=Math.pow(2,n)-1,i=void 0===t.op?t.name:t.name+"_"+t.op,s="slider".concat(e.learning?" learn":"").concat(e.activeParameter===i?" active":"").concat(null!==e.mapping[i]?" mapped":"");return a.a.createElement("div",{className:s,onClick:function(t){t.preventDefault(),e.setActiveParameter(i)},"aria-hidden":"true"},a.a.createElement("label",null,t.name),a.a.createElement("input",{type:"range",step:1,min:0,max:o,value:e.params[i],onChange:function(t){t.preventDefault(),e.updateParam(i,parseInt(t.target.value)),e.setActiveParameter(i)}}),a.a.createElement("span",null,e.params[i]+(e.learning?" - CC "+e.mapping[i]:"")))},F=function(t){return a.a.createElement("div",{className:"operator"},a.a.createElement(V,{name:"ar",op:t.op}),a.a.createElement(V,{name:"d1",op:t.op}),a.a.createElement(V,{name:"sl",op:t.op}),a.a.createElement(V,{name:"d2",op:t.op}),a.a.createElement(V,{name:"rr",op:t.op}),a.a.createElement(V,{name:"tl",op:t.op}),a.a.createElement(j,{op:t.op}),a.a.createElement(V,{name:"mul",op:t.op}),a.a.createElement(V,{name:"det",op:t.op}),a.a.createElement(V,{name:"rs",op:t.op}),a.a.createElement(V,{name:"am",op:t.op}))};var K=function(t){var e=Object(r.useContext)(g);return a.a.createElement("div",{className:"channel"},a.a.createElement("div",{className:"four-cols"},a.a.createElement("div",{className:"col"},a.a.createElement(V,{name:"fb"}),a.a.createElement(V,{name:"ams"})),a.a.createElement("div",{className:"col"},a.a.createElement(V,{name:"st"}),a.a.createElement(V,{name:"fms"})),a.a.createElement("div",{className:"col"},a.a.createElement(V,{name:"al"})),a.a.createElement("div",{className:"col"},a.a.createElement("pre",{className:"algorithm"},function(t){switch(t){case 0:return"\n\n\n\n╔═╗ ╔═╗ ╔═╗ ╔═╗\n║1╠═╣2╠═╣3╠═╣4╠══\n╚═╝ ╚═╝ ╚═╝ ╚═╝\n\n\n\n";case 1:return"\n\n╔═╗\n║1╠═╗\n╚═╝ ║  ╔═╗  ╔═╗\n    ╠══╣3╠══╣4╠══\n╔═╗ ║  ╚═╝  ╚═╝\n║2╠═╝\n╚═╝\n\n";case 2:return"\n\n     ╔═╗\n     ║1╠═╗\n     ╚═╝ ║  ╔═╗\n         ╠══╣4╠══\n╔═╗  ╔═╗ ║  ╚═╝\n║2╠══╣3╠═╝\n╚═╝  ╚═╝\n\n";case 3:return"\n\n╔═╗  ╔═╗\n║1╠══╣2╠═╗\n╚═╝  ╚═╝ ║  ╔═╗\n         ╠══╣4╠══\n     ╔═╗ ║  ╚═╝\n     ║3╠═╝\n     ╚═╝\n\n";case 4:return"\n\n╔═╗  ╔═╗\n║1╠══╣2╠═╗\n╚═╝  ╚═╝ ║\n         ╠══\n╔═╗  ╔═╗ ║\n║3╠══╣4╠═╝\n╚═╝  ╚═╝\n\n";case 5:return"\n      ╔═╗\n    ╔═╣2╠══╗\n    ║ ╚═╝  ║\n╔═╗ ║ ╔═╗  ║\n║1╠═╬═╣3╠══╬══\n╚═╝ ║ ╚═╝  ║\n    ║ ╔═╗  ║\n    ╚═╣4╠══╝\n      ╚═╝\n";case 6:return"\n ╔═╗  ╔═╗\n ║1╠══╣2╠══╗\n ╚═╝  ╚═╝  ║\n      ╔═╗  ║\n      ║3╠══╬══\n      ╚═╝  ║\n      ╔═╗  ║\n      ║4╠══╝\n      ╚═╝\n";case 7:return"\n\n\n╔═╗ ╔═╗ ╔═╗ ╔═╗\n║1║ ║2║ ║3║ ║4║\n╚╦╝ ╚╦╝ ╚╦╝ ╚╦╝\n ╚═══╩═╦═╩═══╝\n       ║\n       ╚══\n\n";default:return"no algorithm"}}(e.params.al)))),a.a.createElement("div",{className:"four-cols"},a.a.createElement("div",{className:"col"},a.a.createElement(F,{op:0})),a.a.createElement("div",{className:"col"},a.a.createElement(F,{op:2})),a.a.createElement("div",{className:"col"},a.a.createElement(F,{op:1})),a.a.createElement("div",{className:"col"},a.a.createElement(F,{op:3}))))},T=function(t){var e=Object(r.useContext)(g),n="cv-input".concat(e.learning?" learn":"").concat(e.activeParameter===t.code?" active":"").concat(null!==e.mapping[t.code]?" mapped":"");return a.a.createElement("div",{className:n,onClick:function(n){n.preventDefault(),e.setActiveParameter(t.code)},"aria-hidden":"true"},a.a.createElement("span",null,t.code+" "+e.params[t.code]+(e.learning?" - CC: "+e.mapping[t.code]:"")))},U=function(t){var e=Object(r.useContext)(g),n=function(t){t.preventDefault();var n=parseInt(t.target.attributes.voice.value);e.selectVoice(n)};return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"globals"},a.a.createElement("h5",null,"Globals"),a.a.createElement("div",{className:"four-cols"},a.a.createElement("div",{className:"col"},a.a.createElement(V,{name:"lfo"}),a.a.createElement(V,{name:"play-mode"}),a.a.createElement(V,{name:"vel-sensitivity"})),a.a.createElement("div",{className:"col"},a.a.createElement(V,{name:"cc-mode"}),a.a.createElement(V,{name:"rgb-intensity"})),a.a.createElement("div",{className:"col"},a.a.createElement(T,{code:"x"}),a.a.createElement(T,{code:"y"}),a.a.createElement(T,{code:"z"})),a.a.createElement("div",{className:"col"},a.a.createElement("ul",null,a.a.createElement("li",null,a.a.createElement("a",{href:"/",onClick:function(t){t.preventDefault(),e.sendVoice()}},"Send Voice")),a.a.createElement("li",null,a.a.createElement("a",{href:"/",onClick:function(t){t.preventDefault()}},"Send Patch")),a.a.createElement("li",null,a.a.createElement("a",{href:"/",onClick:function(t){t.preventDefault()}},"Send Mapping")))))),a.a.createElement("nav",null,[0,1,2,3,4,5].map((function(t){return a.a.createElement("a",{href:"/",className:e.voice===t?"active":"",key:t,voice:t,onClick:n,title:"Show voice "+(t+1)},""+(t+1))}))),a.a.createElement(K,null))};var R=function(t){var e,n;function r(){return t.apply(this,arguments)||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){return a.a.createElement(_,null,a.a.createElement(A,null),a.a.createElement(P,null),a.a.createElement(L,null),a.a.createElement(U,null))},r}(a.a.Component);var B=function(t){var e,n;function r(){return t.apply(this,arguments)||this}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){return a.a.createElement(c,{location:this.props.location},a.a.createElement(u.a,{title:"cv2612"}),a.a.createElement(R,null))},r}(a.a.Component);e.default=B},o0o1:function(t,e,n){t.exports=n("ls82")},pPhb:function(t,e){t.exports={_setState:function(t){t||(t={}),this._state={},this._extendState({polyphony:4,rows:1,priority:"last",rootNote:60,octaveControls:!0,octave:0,velocityControls:!0,velocity:127,keys:[],buffer:[]}),this._extendState(t)},_extendState:function(t){for(var e in t)this._state[e]=t[e]},set:function(){var t=this;return 1===arguments.length?t._extendState(arguments[0]):t._state[arguments[0]]=arguments[1],this},get:function(t){return this._state[t]}}},sFw1:function(t,e,n){n("7DDg")("Int8",1,(function(t){return function(e,n,r){return t(this,e,n,r)}}))},upKx:function(t,e,n){"use strict";var r=n("S/j/"),a=n("d/Gc"),o=n("ne8i");t.exports=[].copyWithin||function(t,e){var n=r(this),i=o(n.length),s=a(t,i),c=a(e,i),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?i:a(u,i))-c,i-s),f=1;for(c<s&&s<c+l&&(f=-1,c+=l-1,s+=l-1);l-- >0;)c in n?n[s]=n[c]:delete n[s],s+=f,c+=f;return n}},zcix:function(t,e,n){var r=n("pPhb"),a=n("P34o"),o=n("Rhw0"),i=n("6eW1"),s=n("Wjup"),c=n("1Gk3");function u(t){this._setState(t),this._listeners={},this._bind()}u.prototype._setState=r._setState,u.prototype._extendState=r._extendState,u.prototype.set=r.set,u.prototype.get=r.get,u.prototype.down=a.down,u.prototype.up=a.up,u.prototype._trigger=a._trigger,u.prototype._bind=a._bind,u.prototype._map=o._map,u.prototype._offset=o._offset,u.prototype._isNote=o._isNote,u.prototype._toFrequency=o._toFrequency,u.prototype._keyMap=o._keyMap,u.prototype._addKey=i._addKey,u.prototype._removeKey=i._removeKey,u.prototype._isPressed=i._isPressed,u.prototype._makeNote=i._makeNote,u.prototype.clear=i.clear,u.prototype._update=i._update,u.prototype._diff=i._diff,u.prototype._prioritize=s._prioritize,u.prototype._last=s._last,u.prototype._first=s._first,u.prototype._highest=s._highest,u.prototype._lowest=s._lowest,u.prototype._isSpecialKey=c._isSpecialKey,u.prototype._specialKey=c._specialKey,u.prototype._specialKeyMap=c._specialKeyMap,t.exports=u}}]);
//# sourceMappingURL=component---src-pages-labs-cv-2612-js-498c80868238971b7b9a.js.map