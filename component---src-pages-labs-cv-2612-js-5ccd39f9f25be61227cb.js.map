{"version":3,"sources":["webpack:///./src/layouts/cv2612.js","webpack:///./src/components/cv2612/utils/patches-utils.js","webpack:///./src/components/cv2612/context.js","webpack:///./src/components/cv2612/utils/obj_diff.js","webpack:///./src/components/cv2612/midi.js","webpack:///./src/components/cv2612/emulator.js","webpack:///./src/components/cv2612/sequencer.js","webpack:///./src/components/cv2612/patches.js","webpack:///./src/components/cv2612/envelope.js","webpack:///./src/components/cv2612/slider.js","webpack:///./src/components/cv2612/operator.js","webpack:///./src/components/cv2612/channel.js","webpack:///./src/components/cv2612/utils/algorithmAscii.js","webpack:///./src/components/cv2612/channels.js","webpack:///./src/components/cv2612/device.js","webpack:///./src/pages/labs/cv2612.js","webpack:///./.cache/gatsby-browser-entry.js","webpack:///./.cache/public-page-renderer.js","webpack:///./src/components/seo.js","webpack:///./.cache/public-page-renderer-prod.js","webpack:///./src/components/header/brand.js"],"names":["Layout","render","children","this","props","react_default","a","createElement","id","Helmet_default","bodyAttributes","class","brand","title","React","Component","dmp2patch","name","d","params","ch","op","o","replace","emptyParams","bitness","param","bits","_i","_groups","length","some","k","endsWith","emptyMapping","mapping","key","cc","CV2612Context","createContext","ctrlmap","Consumer","CV2612Provider","_this","_React$Component","call","handleCC","val","state","activeParameter","learning","Object","assign","setState","reactLocalStorage","setObject","_Object$entries","entries","_Object$entries$_i","m","step","Math","pow","v","floor","updateParam","toggleLearning","sendParameter","code","value","parts","split","parseInt","pId","indexOf","console","error","chan","addr","midi","sendSysexSet","emulator","update","sendParameters","_i2","_Object$entries2","_Object$entries2$_i","setActiveParameter","updateParams","newParams","loadingPatch","_i3","_Object$entries3","_Object$entries3$_i","filterChannel","filters","envelopes","soundOn","componentDidMount","savedMapping","getObject","keys","_i4","_Object$entries4","_Object$entries4$_i","componentDidUpdate","prevProps","prevState","b","diff","reduce","_Object$assign","updateOmniIfChanged","updateEnvelopesIfChanged","_i5","_Object$keys","p","i","j","_this2","env_params","envs","acc","push","substring","filter","x","forEach","e","env","calculateEnvelopePoints","x1","round","ar","y1","tl","x2","d1","y2","sl","x3","d2","rr","map","join","Provider","Midi","midiCtrlInId","midiInId","midiOutId","midiAccess","onChangeMidiIn","ev","setMidiIn","target","onChangeMidiCtrlIn","setMidiCtrlIn","onChangeMidiOut","setMidiOut","sysexCount","sendSysex","data","sendMidi","log","msg","chksum","ma","midiOut","outputs","get","send","onMIDIStateChange","refreshMidiPorts","onCtrlMIDIMessage","Array","from","type","context","lastMsg","noteOn","noteOff","onMIDIMessage","JSON","stringify","onLearnClick","preventDefault","onPanicClick","onClearClick","onToggleSoundClick","toggleSound","midiIns","midiOuts","navigator","requestMIDIAccess","sysex","then","onstatechange","set","sendHandshake","midiIn","inputs","onmidimessage","values","includes","className","onChange","href","onClick","fa","contextType","kb","AudioKeys","polyphony","rows","priority","octave","Emulator","audioCtx","tick","stopAnimation","drawScope","drawSpectrum","requestAnimationFrame","note","f","onKeyDown","frequency","onKeyUp","ym2612Node","notes","setFrequency","keyOn","splice","keyOff","channels","ch_off","mask","size","shift","write","suspend","resume","initialize","fftSize","AudioContext","down","up","scope","refs","getContext","fillStyle","lineWidth","strokeStyle","spectrum","timeData","Uint8Array","fill","freqData","componentWillUnmount","_listeners","ctx","width","canvas","height","l","scaling","analyser","getByteTimeDomainData","fillRect","beginPath","it","lineTo","stroke","scalingX","getByteFrequencyData","min","max","exp","logindex","low","high","ceil","lv","audioWorklet","addModule","AudioWorkletNode","outputChannelCount","port","onmessage","event","connect","destination","createAnalyser","block","freq","address","postMessage","ref","seqTimeOut","seqNote","seqNoteOn","Sequencer","sequencerOn","sequencerStop","clearTimeout","sequencerTick","sort","random","duration","setTimeout","Patches","addDmpPatch","patch","patches","save","onChangeHandler","_loop","_isArray","_iterator","_ref","next","done","fr","FileReader","onload","Int8Array","result","readAsArrayBuffer","files","isArray","Symbol","iterator","current","blur","onSave","onCreate","prompt","onDelete","onLoadDefaults","loadDefaultPatches","onLeftClick","onRightClick","onUploadClick","file","click","r","XMLHttpRequest","onreadystatechange","readyState","status","_loop2","_isArray2","_iterator2","_ref2","responseType","response","open","encodeURI","responseText","loadPatch","style","display","accept","multiple","Envelope","viewBox","xmlns","points","defaultProps","Slider","mapped","Operator","slider","envelope","Channel","algorithm","algorithmAscii","operator","Channels","onFilterChannel","attributes","Fragment","channel","Device","sequencer","cv2612_patches","CV2612Index","cv2612","location","seo","device","__webpack_require__","__webpack_exports__","StaticQuery","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","gatsby_link__WEBPACK_IMPORTED_MODULE_2__","gatsby_link__WEBPACK_IMPORTED_MODULE_2___default","StaticQueryContext","staticQueryData","query","propTypes","PropTypes","object","string","isRequired","func","module","exports","require","default","SEO","description","lang","meta","keywords","react__WEBPACK_IMPORTED_MODULE_1___default","gatsby__WEBPACK_IMPORTED_MODULE_4__","detailsQuery","metaDescription","site","siteMetadata","react_helmet__WEBPACK_IMPORTED_MODULE_3___default","htmlAttributes","titleTemplate","content","property","author","concat","_public_static_d_1025518380_json__WEBPACK_IMPORTED_MODULE_0__","array","arrayOf","ProdPageRenderer","pageResources","loader","getResourcesForPathnameSync","pathname","InternalPageRenderer","json","shape","swaps","Brand","getDiff","timer","to","intervalId","setInterval","bind","clearInterval","react__WEBPACK_IMPORTED_MODULE_2___default","gatsby__WEBPACK_IMPORTED_MODULE_3__"],"mappings":"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","file":"component---src-pages-labs-cv-2612-js-5ccd39f9f25be61227cb.js","sourcesContent":["import React from \"react\"\nimport Brand from \"../components/header/brand\"\nimport Helmet from \"react-helmet\"\n\nclass Layout extends React.Component {\n\n  render() {\n    const { children } = this.props\n\n    return (\n      <div id=\"app\">\n        <header>\n          <Helmet bodyAttributes={{class:'dark cv2612'}} />\n          <Brand title=\"diego dorado\"/>\n        </header>\n        <main>{children}</main>\n      </div>\n    )\n  }\n}\n\nexport default Layout\n","export const dmp2patch = (name,d) =>{\n    //version 9 or 11, genesis, FM patch\n    if( (d[0]===0x09 && d[1]===0x01 && d[2]===0x00)\n        || ( d[0]===0x0B && d[1]===0x02 && d[2]===0x01) ){\n\n        /*\n\n        http://www.deflemask.com/DMP_SPECS.txt\n\n        1 Byte: LFO (FMS on YM2612, PMS on YM2151)\n        1 Byte: FB\n        1 Byte: ALG\n        1 Byte: LFO2 (AMS on YM2612, AMS on YM2151)\n        Repeat this TOTAL_OPERATORS times\n          1 Byte: MULT\n          1 Byte: TL\n          1 Byte: AR\n          1 Byte: DR\n          1 Byte: SL\n          1 Byte: RR\n          1 Byte: AM\n          1 Byte: RS\n          1 Byte: DT (DT2<<4 | DT on YM2151)\n          1 Byte: D2R\n          1 Byte: SSGEG_Enabled <<3 | SSGEG\n          */\n          const params = {}\n          params[`6_4_lfo`] = 0\n          params[`6_4_en`] = 0\n          for(let ch=0;ch<=6;ch++){\n            //repeat for 6 channels, and omni channel too\n            params[`${ch}_4_fms`] = d[3]\n            params[`${ch}_4_fb`] = d[4]\n            params[`${ch}_4_al`] = d[5]\n            params[`${ch}_4_ams`] = d[6]\n            params[`${ch}_4_st`] = 3\n            for(let op=0;op<=4;op++){\n              //use first op as omni op\n              const o = (op===4?0:op)*11+7\n              params[`${ch}_${op}_mul`] = d[o+0]\n              params[`${ch}_${op}_tl`] = d[o+1]\n              params[`${ch}_${op}_ar`] = d[o+2]\n              params[`${ch}_${op}_d1`] = d[o+3]\n              params[`${ch}_${op}_sl`] = d[o+4]\n              params[`${ch}_${op}_rr`] = d[o+5]\n              params[`${ch}_${op}_am`] = d[o+6]\n              params[`${ch}_${op}_rs`] = d[o+7]\n              params[`${ch}_${op}_det`] = d[o+8]\n              params[`${ch}_${op}_d2`] = d[o+9]\n            }\n          }\n\n          return {name: name.replace('.dmp',''), params: params}\n    }\n    //else\n    return null\n\n}\n\n\nexport const emptyParams = () =>{\n  const params = {}\n  params[`6_4_lfo`] = 0\n  params[`6_4_en`] = 0\n  for(let ch=0;ch<=6;ch++){\n    //repeat for 6 channels, and omni channel too\n    params[`${ch}_4_fms`] = 0\n    params[`${ch}_4_fb`] = 0\n    params[`${ch}_4_al`] = 0\n    params[`${ch}_4_ams`] = 0\n    params[`${ch}_4_st`] = 3\n    for(let op=0;op<=4;op++){\n      params[`${ch}_${op}_mul`] = 0\n      params[`${ch}_${op}_tl`] = 0\n      params[`${ch}_${op}_ar`] = 0\n      params[`${ch}_${op}_d1`] = 0\n      params[`${ch}_${op}_sl`] = 0\n      params[`${ch}_${op}_rr`] = 0\n      params[`${ch}_${op}_am`] = 0\n      params[`${ch}_${op}_rs`] = 0\n      params[`${ch}_${op}_det`] = 0\n      params[`${ch}_${op}_d2`] = 0\n    }\n  }\n  return params\n}\n\n\nexport const bitness = (param) =>{\n  const groups = [\n    ['am','en'],\n    ['rs','st','ams'],\n    ['det','al','fb','fms','lfo'],\n    ['sl','rr','mul'],\n    ['ar','d2','d1'],\n    [],\n    ['tl'],\n  ]\n  let bits = 1\n  for(let group of groups){\n    if (group.some((k) => param.endsWith(k)))\n      return bits\n    bits++\n  }\n  return 0\n}\n\nexport const emptyMapping = () =>{\n  //todo, move bitness aways from mapping\n  const mapping = emptyParams()\n  for (let key in mapping) {\n    mapping[key] = {cc:null, ch:null}\n  }\n  return mapping\n}\n","import React from \"react\"\nimport {emptyParams, emptyMapping, bitness} from \"./utils/patches-utils\"\nimport obj_diff from \"./utils/obj_diff\"\nimport {reactLocalStorage} from 'reactjs-localstorage'\n\nexport const CV2612Context = React.createContext()\nexport const CV2612Consumer = CV2612Context.Consumer\n\nconst ctrlmap = ['ar','d1','sl','d2','rr','tl','mul','det','rs','am','al','fb','ams','fms','st','lfo','en']\n\n// Create the provider using a traditional React.Component class\nclass CV2612Provider extends React.Component {\n\n  constructor(props){\n    super(props);\n\n    this.state = {\n      midi: null,\n      emulator: null,\n      learning: false,\n      activeParameter: null,\n      envelopes: {},\n      mapping: emptyMapping(),\n      params: emptyParams(),\n      filters:{ch: 6},\n      soundOn: false,\n      setActiveParameter: this.setActiveParameter,\n      updateParam: this.updateParam,\n      updateParams: this.updateParams,\n      filterChannel: this.filterChannel,\n      toggleLearning: this.toggleLearning,\n      handleCC: this.handleCC,\n      sendParameters : this.sendParameters,\n    }\n  }\n\n  componentDidMount(){\n\n    const savedMapping = reactLocalStorage.getObject('mapping',{})\n    if(Object.keys(savedMapping).length>0){\n      let mapping = {...this.state.mapping}\n      for (let [code, value] of Object.entries(savedMapping)) {\n        mapping[code] = value\n      }\n      this.setState({mapping:mapping})\n    }\n  }\n\n  handleCC = (ch,cc, val)=>{\n    const k = this.state.activeParameter\n    if(this.state.mapping[k] && this.state.learning){\n      let mapping = {...this.state.mapping}\n      if(mapping[k].ch !== ch && mapping[k].cc !== cc){\n        mapping[k].ch = ch\n        mapping[k].cc = cc\n        this.setState({mapping: mapping})\n        reactLocalStorage.setObject('mapping',mapping)\n      }\n    }\n\n    for (let [k, m] of Object.entries(this.state.mapping)) {\n      if(m.cc === cc && m.ch === ch){\n        const bits = bitness(k)\n        const resolution = Math.pow(2,bits)\n        const step = 128/resolution\n        const v = Math.floor(val/step)\n        this.updateParam(k,v)\n      }\n    }\n\n  }\n\n  toggleLearning = () =>{\n    this.setState({learning: !this.state.learning})\n  }\n\n  sendParameter = (code, value) => {\n    const parts = code.split('_')\n    const ch = parseInt(parts[0])\n    const op = parseInt(parts[1])\n    const param = parts[2]\n    const pId = ctrlmap.indexOf(param)\n\n    if(pId===-1){\n      console.error(`Unexpected param ${param} in code ${code}`)\n    }else{\n\n       //todo: implement omni channel on chip side\n       // and avoid resending parameters triggered by omni channel\n      if(ch===6){\n        for(let chan=0;chan<5;chan++){\n          const addr = [chan,op,pId]\n          this.state.midi.sendSysexSet(addr,value)\n        }\n      }else{\n        const addr = [ch,op,pId]\n        this.state.midi.sendSysexSet(addr,value)\n      }\n\n      this.state.emulator.update(ch,op,param,value,this.state.params)\n\n    }\n\n  }\n\n\n  sendParameters = (params) => {\n    //todo: send a bulk sysex message  instead\n    for (let [code, value] of Object.entries(params)) {\n      this.sendParameter(code,value)\n    }\n\n  }\n\n  setActiveParameter = (param) => {\n    this.setState({activeParameter: param})\n  }\n\n  updateParam = (code,value) => {\n    let params = {...this.state.params}\n    params[code] = value\n    this.setState({params: params})\n  }\n\n  updateParams = (newParams, loadingPatch) => {\n    let params = {...this.state.params}\n    for (let [code, value] of Object.entries(newParams)) {\n      params[code] = value\n    }\n    this.setState({params: params})\n    this.loadingPatch =  loadingPatch\n  }\n\n  filterChannel= (ch) => {\n    let filters = {...this.state.filters}\n    filters.ch = ch\n    this.setState({filters})\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    //which params have changed?\n\n    const diff = obj_diff(prevState.params, this.state.params)\n    if(Object.entries(diff).length>0){\n      this.sendParameters(diff)\n      if(this.loadingPatch)\n        this.loadingPatch = false\n      else\n        this.updateOmniIfChanged(diff)\n      this.updateEnvelopesIfChanged(diff)\n    }\n  }\n\n  // if any omni channel/op parameter has changed\n  updateOmniIfChanged(diff){\n    const params = {}\n\n    //todo: exclude lfo\n    for(let k of Object.keys(diff)){\n      const p = k.split('_')\n      //is omni channel?\n      if(p[0]==='6'){\n        for(let i=0;i<=6;i++){\n          //is omni param?\n          if(p[1]==='4')\n            for(let j=0;j<=4;j++)\n              params[`${i}_${j}_${p[2]}`] = diff[k]\n          else\n            params[`${i}_${p[1]}_${p[2]}`] = diff[k]\n        }\n      }else{\n        //is omni param?\n        if(p[1]==='4')\n          for(let i=0;i<=4;i++)\n            params[`${p[0]}_${i}_${p[2]}`] = diff[k]\n      }\n    }\n\n    if(Object.entries(params).length>0){\n      this.updateParams(params,false)\n    }\n\n  }\n\n\n  updateEnvelopesIfChanged(diff){\n    //check if any envelope should change\n    const env_params = ['ar','d1','sl','d2','rr','tl']\n    const envs = Object.keys(diff).reduce((acc, key) => {\n      if (env_params.some((a) => key.endsWith(a)))\n        //accumulates channel_operator to identify envelope to update\n        acc.push(key.substring(0,3))\n      return acc\n    }, [])\n      .filter((x, i, a) => a.indexOf(x) === i) //filter unique\n\n    //update envelopes?\n    if(envs.length){\n      let envelopes = {...this.state.envelopes}\n      envs.forEach( (e) => {\n        const env = env_params\n          .reduce((acc,i)=>{acc[`${i}`]=this.state.params[`${e}_${i}`];return acc},{})\n        envelopes[e] = this.calculateEnvelopePoints(env)\n      })\n      this.setState({envelopes: envelopes})\n    }\n  }\n\n  calculateEnvelopePoints(env){\n    const x1 = Math.round((31-env.ar)/31*100)\n    const y1 = Math.round(env.tl/127*100)\n    const x2 = Math.round(x1+(31-env.d1)/31*100)\n    const y2 = Math.round(y1+(100-y1)*(env.sl/15))\n    const x3 = Math.round(x2+(31-env.d2)/31*50+50)\n    const y3 = Math.round(y2+(100-y2)*(0.5*(env.d2/31)))\n    const x4 = Math.round(x3+(31-env.rr)/31*100)\n\n    const points = [\n        [0,100],\n        [x1,y1],\n        [x2,y2],\n        [x3,y3],\n        [x4,100]\n      ]\n    return points.map((p)=>p.join(',')).join(' ').replace(/NaN/g,'0')\n  }\n\n\n  render () {\n    return (\n      // value prop is where we define what values\n      // that are accessible to consumer components\n       <CV2612Context.Provider value={this.state}>\n        {this.props.children}\n      </CV2612Context.Provider>\n    )\n  }\n}\n\nexport default CV2612Provider\n","export default function obj_diff(a,b){\n  return Object.keys(b).reduce((diff, key) => {\n    if (a[key] === b[key]) return diff\n    return {\n      ...diff,\n      [key]: b[key]\n    }\n  }, {})\n}\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport {reactLocalStorage} from 'reactjs-localstorage'\nimport { FaSlidersH,\n         FaTrash,\n         FaGhost\n        } from 'react-icons/fa'\n\n\n//todo: move midi stuff to midi-utils.js\n//warning: this component cannot be unmounted\nclass Midi extends React.Component {\n  static contextType = CV2612Context\n\n  midiCtrlInId = ''\n  midiInId = ''\n  midiOutId = ''\n  midiAccess= null\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      midiIns: [],\n      midiOuts: [],\n    }\n\n  }\n\n  componentDidMount(){\n    navigator.requestMIDIAccess( { sysex: true }).then(\n      (ma)=>{\n        this.midiAccess = ma\n        this.refreshMidiPorts()\n        ma.onstatechange = this.onMIDIStateChange\n      },()=>console.log('Could not access your MIDI devices.'))\n\n    this.context.midi = this\n  }\n\n\n  onChangeMidiIn = (ev) => {\n    this.setMidiIn(ev.target.value)\n  }\n\n  onChangeMidiCtrlIn = (ev) => {\n    this.setMidiCtrlIn(ev.target.value)\n  }\n\n  onChangeMidiOut = (ev) => {\n    this.setMidiOut(ev.target.value)\n  }\n\n  setMidiOut(id){\n    this.midiOutId = id\n    this.setState({midiOutId: id})\n    reactLocalStorage.set('midiOutId',id)\n    this.sendHandshake()\n  }\n\n  setMidiIn(id){\n    this.midiInId = id\n    this.setState({midiInId: id})\n    reactLocalStorage.set('midiInId',id)\n    const midiIn = this.midiAccess.inputs.get(id)\n    if(midiIn){\n      midiIn.onmidimessage = this.onMIDIMessage\n    }else{\n      console.log('Midi In error')\n    }\n  }\n\n\n  setMidiCtrlIn(id){\n    this.midiCtrlInId = id\n    this.setState({midiCtrlInId: id})\n    reactLocalStorage.set('midiCtrlInId',id)\n    const midiIn = this.midiAccess.inputs.get(id)\n    if(midiIn){\n      midiIn.onmidimessage = this.onCtrlMIDIMessage\n    }else{\n      console.log('Midi Ctrl In error')\n    }\n  }\n\n\n\n  sendHandshake(){\n    // device ID request\n    const msg = [0xF0, 0x7E, 0x7F, 0x06, 0x01, 0xF7]\n    this.sendSysex(msg)\n\n  }\n\n  sysexCount = 0\n  sendSysex = (data) => {\n    this.sendMidi(data)\n    this.sysexCount++\n    console.log('sysexCount',this.sysexCount)\n  }\n\n  sendSysexSet = (addr,value) => {\n    // send data header\n    const msg = [0xF0, 0x41, 0x26, 0x12, 0x12]\n    // part 6 is a three bytes address\n    // part 7 is the data itself, in this case, a single 7-bit\n    // part 8 is the cheksum , 0x7F - the sum of address and value\n    const chksum = 0x7F - ((addr[0]+addr[1]+addr[2]+value)%0x7F)\n    msg.push(addr[0])\n    msg.push(addr[1])\n    msg.push(addr[2])\n    msg.push(value)\n    msg.push(chksum)\n    // part 9  is the end byte\n    msg.push(0xF7)\n    this.sendSysex(msg)\n  }\n\n  sendMidi = (data) => {\n    const ma = this.midiAccess\n    if(ma===null){\n      return\n    }\n    const midiOut = ma.outputs.get(this.midiOutId)\n    if(midiOut){\n      midiOut.send(data)\n    }else{\n      console.log('No Midi Out')\n    }\n  }\n\n  onMIDIStateChange = (e) => {\n    this.refreshMidiPorts()\n  }\n\n  refreshMidiPorts() {\n    const ma = this.midiAccess\n    const inputs = Array.from(ma.inputs.values())\n    const outputs = Array.from(ma.outputs.values())\n\n    this.setState({midiIns:inputs, midiOuts:outputs})\n\n    if(inputs.length){\n      let id = reactLocalStorage.get('midiInId','')\n      // is last id still available??\n      if( id!=='' && !inputs.map(i=>i.id).includes(id) ){\n        id = inputs[0].id\n      }\n      if(id !== this.midiInId)\n        this.setMidiIn(id)\n\n      id = reactLocalStorage.get('midiCtrlInId','')\n      // is last id still available??\n      if( id!=='' && !inputs.map(i=>i.id).includes(id) ){\n        id = inputs[0].id\n      }\n      if(id !== this.midiCtrlInId)\n        this.setMidiCtrlIn(id)\n\n    }\n    if(outputs.length){\n      let id = reactLocalStorage.get('midiOutId','')\n      // is last id still available??\n      if( id!=='' &&  !outputs.map(o=>o.id).includes(id) ){\n        id = outputs[0].id\n      }\n      if(id !== this.midiOutId)\n        this.setMidiOut(id)\n    }\n  }\n\n\n\n  onCtrlMIDIMessage = (msg) => {\n    //warning: filter loopback messages somehow\n\n    if(msg.target.id !== this.midiCtrlInId)\n      return\n\n    const data = Array.from(msg.data)\n    const type = data[0] & 0xf0\n\n    if(type === 0xB0){\n      const ch = data[0] & 0x0f\n      const cc = data[1] & 0x7f\n      const val = data[2] & 0x7f\n      this.context.handleCC(ch,cc, val)\n      this.setState({lastMsg: `${type},${ch},${cc},${val}` })\n    }\n\n    // resend noteon/off events\n    if(type === 0x80 || type === 0x90){\n      this.sendMidi(data)\n      if(type === 0x90){\n        this.context.emulator.noteOn(data[1])\n      }else{\n        this.context.emulator.noteOff(data[1])\n      }\n    }\n\n  }\n\n\n  onMIDIMessage = (msg) => {\n\n    if(msg.target.id !== this.midiInId)\n      return\n\n    const data = Array.from(msg.data)\n    const type = data[0] & 0xf0\n\n    if(type===0xF0){ // sysex\n      const idReply = [0xF0, 0x7E, 0x00, 0x06, 0x02,  //identity reply\n          0x26, 0x26, 0x12, 0x00, 0x00, // ID - family code - model number\n          0x01, 0x00, 0x00, 0x00, 0xF7] //version - end\n      if(JSON.stringify(data) === JSON.stringify(idReply)){\n        console.log(`CV2612 found!`)\n      }else{\n        //console.log('sysex reply ')\n        //console.log(data)\n      }\n      return\n    }\n\n  }\n\n  onLearnClick = (e) => {\n    e.preventDefault()\n    this.context.toggleLearning()\n  }\n\n  onPanicClick = (e) => {\n    e.preventDefault()\n    this.sendMidi([0xFF])\n  }\n\n  onClearClick = (e) => {\n    e.preventDefault()\n    this.sendSysexSet([0x06,0x04,0x11],0x00)\n  }\n\n  onToggleSoundClick = (e) => {\n    e.preventDefault()\n    this.context.toggleSound()\n  }\n\n  render() {\n    return (\n      <nav className=\"midi\">\n        <span>Ctrl</span>\n        <select value={this.state.midiCtrlInId} onChange={this.onChangeMidiCtrlIn}>\n          <option key=\"\" value=\"\">Not Connected</option>\n          {this.state.midiIns.map((i) =><option key={i.id} value={i.id}>{i.name}</option>)}\n        </select>\n        <span>In</span>\n        <select value={this.state.midiInId} onChange={this.onChangeMidiIn}>\n          <option key=\"\" value=\"\">Not Connected</option>\n          {this.state.midiIns.map((i) =><option key={i.id} value={i.id}>{i.name}</option>)}\n        </select>\n        <span>Out</span>\n        <select value={this.state.midiOutId} onChange={this.onChangeMidiOut}>\n          <option key=\"\" value=\"\">Not Connected</option>\n          {this.state.midiOuts.map((o) =><option key={o.id} value={o.id}>{o.name}</option>)}\n        </select>\n        <a className={this.context.learning ? 'learning':''} href=\"/\" title=\"Click to Learn\" onClick={this.onLearnClick}><FaSlidersH/></a>\n        <a href=\"/\" title=\"Click if panic\" onClick={this.onPanicClick}><FaGhost/></a>\n        <a href=\"/\" title=\"Click to clear midi mapping\" onClick={this.onClearClick}><FaTrash/></a>\n      </nav>\n    )\n  }\n}\n\nexport default Midi;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport AudioKeys from 'audiokeys'\nimport { FaVolume,\n         FaVolumeSlash\n        } from 'react-icons/fa'\n\n//todo: update for all 6 channels\n//todo: unload properly\n\nconst kb = new AudioKeys({polyphony: 1,rows: 1,priority: 'last',octave: 2})\n\n\nclass Emulator extends React.Component {\n  static contextType = CV2612Context\n  audioCtx = null\n\n  constructor(props) {\n    super(props)\n    this.state = {soundOn: false}\n    this.fftSize = 1024\n  }\n\n  componentDidMount(){\n\n    this.audioCtx = new AudioContext()\n    if(this.audioCtx.state==='running')\n       this.initialize()\n\n\n    this.notes = []\n    this.context.emulator = this\n    kb.down(this.onKeyDown)\n    kb.up(this.onKeyUp)\n\n    this.scope = this.refs.scope.getContext(\"2d\")\n    this.scope.fillStyle = 'rgba(0, 20, 0, 0.1)'\n    this.scope.lineWidth = 2;\n    this.scope.strokeStyle = '#509eec'\n    this.spectrum = this.refs.spectrum.getContext(\"2d\")\n    this.spectrum.fillStyle = 'rgba(0, 20, 0, 0.1)'\n    this.spectrum.lineWidth = 1;\n    this.spectrum.strokeStyle = '#509eec'\n\n    this.stopAnimation = false\n    this.timeData = new Uint8Array(this.fftSize).fill(128)\n    this.freqData = new Uint8Array(this.fftSize)\n\n    //requestAnimationFrame(this.tick)\n\n  }\n\n  componentWillUnmount(){\n    this.audioCtx.suspend()\n    kb._listeners.down = []\n    kb._listeners.up = []\n    this.stopAnimation = true\n    this.timeData = null\n    this.freqData = null\n\n  }\n\n  tick = () => {\n    if (this.stopAnimation)\n       return\n\n    this.drawScope()\n    this.drawSpectrum()\n    requestAnimationFrame(this.tick)\n  }\n\n  drawScope(){\n\n    const ctx = this.scope\n    const width = ctx.canvas.width\n    const height = ctx.canvas.height\n    const l = this.fftSize\n    const scaling = height / 256\n\n    if(this.analyser)\n      this.analyser.getByteTimeDomainData(this.timeData)\n\n\n    ctx.fillRect(0, 0, width, height)\n    ctx.beginPath()\n\n    const e = this.timeData.reduce( (acc, it, i, a) => {\n      return ((acc===0) && (i>0) && (i<l-10) && a[i-1]<128 && a[i+10]>128) ? i : acc\n    } , 0)\n\n    for (let x = e; x < l && x - e < width; x++)\n      ctx.lineTo(x - e, height - this.timeData[x] * scaling)\n\n    ctx.stroke()\n  }\n\n  drawSpectrum() {\n    const ctx = this.spectrum\n    const width = ctx.canvas.width\n    const height = ctx.canvas.height\n    const l = this.fftSize\n    const scaling = height / 256\n    const scalingX = width / l\n\n    if(this.analyser)\n      this.analyser.getByteFrequencyData(this.freqData)\n\n    ctx.fillRect(0, 0, width, height)\n    ctx.beginPath()\n\n    const toLog = (value, min, max) =>{\n      const exp = (value-min) / (max-min)\n      return min * Math.pow(max/min, exp)\n    }\n\n\n    for (let i = 1; i < l; i++) {\n      var logindex = toLog(i,1,l-1)\n      //As the logindex will probably be decimal, we need to interpolate (in this case linear interpolation)\n      const low = Math.floor(logindex)\n      const high = Math.ceil(logindex)\n      const lv = this.freqData[low]\n      const hv = this.freqData[high]\n      const w = (logindex-low)/(high-low)\n      const v = lv + (hv-lv)*w\n\n      ctx.lineTo(i*scalingX, height - v * scaling)\n\n    }\n\n    ctx.stroke()\n  }\n\n\n  initialize(){\n\n    this.audioCtx.audioWorklet.addModule('/cv2612/ym2612-processor.js').then(() => {\n      this.ym2612Node = new AudioWorkletNode(this.audioCtx, 'ym2612-generator', { outputChannelCount: [2] })\n      this.ym2612Node.port.onmessage = (event) => {console.log(event.data)}\n      this.ym2612Node.connect(this.audioCtx.destination)\n\n      this.analyser = this.audioCtx.createAnalyser()\n      this.analyser.fftSize = this.fftSize\n      this.ym2612Node.connect(this.analyser)\n\n      this.write(0x27,0x00) //chan3 normal mode\n      this.write(0x28,0x00)\n      // load all patch params\n      this.context.sendParameters(this.context.params)\n    })\n\n     this.setState({soundOn: true})\n\n  }\n\n\n  noteOn = (note) => {\n    const f = ( Math.pow(2, ( note-69 ) / 12) ) * 440.0\n    this.onKeyDown({note:note,frequency:f})\n  }\n\n  noteOff = (note) => {\n    this.onKeyUp({note:note})\n  }\n\n  onKeyDown = (note) => {\n    if(note.note<0 || note.note>127 )\n      return\n\n    this.context.midi.sendMidi([0x90,note.note,0x70])\n\n    if(!this.ym2612Node)\n      return\n\n\n    if(this.notes.indexOf(note.note)===-1)\n      this.notes.push(note.note)\n\n    this.setFrequency(note.frequency)\n\n    if(this.notes.length===1){\n      this.keyOn()\n    }\n  }\n\n  onKeyUp = (note) => {\n    if(note.note<0 || note.note>127 )\n      return\n\n    this.context.midi.sendMidi([0x80,note.note,0x00])\n\n    if(!this.ym2612Node)\n      return\n\n\n    for( let i = 0; i < this.notes.length; i++){\n       if ( this.notes[i] === note.note)\n         this.notes.splice(i, 1)\n    }\n\n    if(this.notes.length===0){\n      this.keyOff()\n    }\n  }\n\n  setFrequency(f) {\n    let block = 2\n    while (f >= 2048) {\n      f /= 2\n      block++\n    }\n    const freq = parseInt(f)\n\n    for(let chan=0;chan<6;chan++){\n      const ch_off = (Math.floor(chan/3) * 0x100 + chan%3 )\n      this.write(0xA4+ch_off, ((freq >> 8) & 0x07) | ( ( block & 0x07 ) << 3))\n      this.write(0xA0+ch_off, freq&0xFF)\n    }\n  }\n\n\n  keyOn() {\n    for(let chan=0;chan<6;chan++)\n      this.write(0x28, 0xF0 + (Math.floor(chan/3) * 4 + chan%3 ) )\n  }\n\n  keyOff() {\n    for(let chan=0;chan<6;chan++)\n      this.write(0x28, 0x00 + (Math.floor(chan/3) * 4 + chan%3 ) )\n  }\n\n\n  write(address,value){\n    if(!this.ym2612Node)\n      return\n\n    //console.log(address.toString(16),value.toString(16))\n    this.ym2612Node.port.postMessage([address,value])\n  }\n\n\n  update = (ch,op,param,value,params) =>{\n    const globals = ['lfo','en']\n    const channels = ['fb','ams','fms','st','al']\n    const operators = ['ar','d1','sl','d2','rr','tl','mul','det','rs','am']\n\n\n    // register filters... somehow messy\n    if((ch===6 || op===4) && operators.includes(param))\n      return\n\n    if((ch===6) && channels.includes(param))\n      return\n\n    if((op!==4) && channels.includes(param))\n      return\n\n    if((op!==4 || ch!==6) && globals.includes(param))\n      return\n\n\n    const ch_off = (Math.floor(ch/3) * 0x100 + ch%3 )\n    const mask = (key,size,shift) =>{\n      return (params[`${ch}_${op}_${key}`] & (Math.pow(2,size)-1))<<shift\n    }\n\n    if(param==='lfo' || param==='en' ){\n      const v = mask('en',1,3)|mask('lfo',3,0)\n      this.write(0x22, v)\n    }\n    else if(param==='det' || param==='mul' ){\n      const v = mask('det',3,4)|mask('mul',4,0)\n      this.write(0x30+4*op+ch_off, v)\n    }\n    else if(param==='tl'){\n      const v = mask('tl',7,0)\n      this.write(0x40+4*op+ch_off, v)\n    }\n    else if(param==='rs' || param==='ar' ){\n      const v = mask('rs',2,6)|mask('ar',5,0)\n      this.write(0x50+4*op+ch_off, v)\n    }\n    else if(param==='am' || param==='d1' ){\n      const v = mask('am',1,7)|mask('d1',5,0)\n      this.write(0x60+4*op+ch_off, v)\n    }\n    else if(param==='d2' ){\n      const v = mask('d2',5,0)\n      this.write(0x70+4*op+ch_off, v)\n    }\n    else if(param==='sl' || param==='rr' ){\n      const v = mask('sl',4,4)|mask('rr',4,0)\n      this.write(0x80+4*op+ch_off, v)\n    }\n    else if(param==='al' || param==='fb' ){\n      const v = mask('fb',3,3)|mask('al',3,0)\n      this.write(0xB0+ch_off, v)\n    }\n    else if(param==='st' || param==='ams'|| param==='fms' ){\n      const v = mask('st',2,6)|mask('ams',2,4)|mask('fms',3,0)\n      this.write(0xB4+ch_off, v)\n    }\n  }\n\n  onToggleSoundClick = (e) => {\n    e.preventDefault()\n\n    if(this.audioCtx.state === 'running') {\n      this.audioCtx.suspend().then(() => {\n        this.setState({soundOn: false})\n      });\n    } else if(this.audioCtx.state === 'suspended') {\n      this.audioCtx.resume().then(()=> {\n        this.initialize()\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"emulator\">\n        <nav>\n          <a href=\"/\" title=\"Toggles Sound\" onClick={this.onToggleSoundClick}>{this.state.soundOn ?<FaVolume/>:<FaVolumeSlash/>}</a>\n        </nav>\n        <canvas ref=\"scope\" width={200} height={60} />\n        <canvas ref=\"spectrum\" width={200} height={60} />\n      </div>\n    )\n  }\n\n}\n\nexport default Emulator;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\n\nlet seqTimeOut\nlet seqNote = 0\nlet seqNoteOn = false\n\nclass Sequencer extends React.Component {\n  static contextType = CV2612Context\n\n  constructor(props){\n    super(props);\n    this.state = {\n      sequencerOn: false,\n    }\n  }\n\n  componentWillUnmount() {\n    this.sequencerStop()\n  }\n\n\n  onClick = (e) => {\n    e.preventDefault()\n    this.setState({sequencerOn: !this.state.sequencerOn})\n  }\n\n  sequencerStop() {\n    clearTimeout(seqTimeOut)\n    if(seqNoteOn){\n      this.context.midi.sendMidi([0x80,seqNote,0x00])\n      seqNoteOn = false\n    }\n  }\n\n  sequencerTick() {\n    if(seqNoteOn){\n      this.context.midi.sendMidi([0x80,seqNote,0x00])\n      seqNoteOn = false\n    }\n    else{\n      //sets a random note\n      seqNote = [0,3,5,7,10].sort(() => Math.random() - 0.5)[0]\n                     + (3+Math.floor(Math.random()*5))*12\n      this.context.midi.sendMidi([0x90,seqNote,100])\n      seqNoteOn = true\n    }\n\n    if(this.state.sequencerOn){\n      const duration = 500/Math.pow(2,Math.floor(Math.random()*5))\n      seqTimeOut = setTimeout(()=> this.sequencerTick(), duration)\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if(prevState.sequencerOn !== this.state.sequencerOn){\n      if(this.state.sequencerOn){\n        this.sequencerTick()\n      }else{\n        this.sequencerStop()\n      }\n    }\n  }\n\n  render() {\n    //todo: fixme\n    return null\n    /*\n    return (\n      <button onClick={this.onClick}>{this.state.sequencerOn ? 'Stop Seq':'Start Seq'}</button>\n    )\n    */\n  }\n}\n\n\nexport default Sequencer\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport {dmp2patch, emptyParams} from \"./utils/patches-utils\"\n\nimport {reactLocalStorage} from 'reactjs-localstorage'\nimport { FaPlus,\n         FaBackspace,\n         FaCaretLeft,\n         FaCaretRight,\n         FaBomb,\n         FaSave,\n         FaUpload\n        } from 'react-icons/fa'\n\n\nclass Patches extends React.Component {\n  static contextType = CV2612Context\n\n  constructor(props){\n    super(props)\n    this.state = {\n      patches: [{name: 'empty', params: emptyParams()}],\n      current: 0,\n    }\n  }\n\n  componentDidMount(){\n    const patches = reactLocalStorage.getObject('patches',[])\n    if(patches.length===0 || Object.keys(patches).length===0){\n      this.loadDefaultPatches()\n    }else{\n      this.setState({patches:patches})\n    }\n  }\n\n  save(patches){\n    reactLocalStorage.setObject('patches',patches)\n    this.setState({patches:patches})\n  }\n\n  loadDefaultPatches(){\n    //empty previous patches\n    this.save([])\n\n    const r = new XMLHttpRequest()\n    r.onreadystatechange = (ev) => {\n      if(r.readyState === 4 && r.status === 200) {\n        const insts = r.responseText.split(/\\r?\\n/).filter( x => x.length>1)\n        for(const i of insts){\n          const r = new XMLHttpRequest()\n          r.responseType = 'arraybuffer'\n          r.onreadystatechange = (ev) => {\n            if(r.readyState === 4 && r.status === 200) {\n              const d = new Int8Array(r.response)\n              this.addDmpPatch(i,d)\n            }\n          }\n          r.open('GET',encodeURI(`/cv2612/instruments/${i}`))\n          r.send(null)\n        }\n      }\n    }\n    r.open('GET', '/cv2612/instruments/index.txt')\n    r.send(null)\n  }\n\n  //todo: load to all voices or current voice\n  componentDidUpdate(prevProps, prevState) {\n    //fixme: if i delete a patch, current doesnt change...\n    if(prevState.current !== this.state.current){\n      const i = parseInt(this.state.current)\n      const patch = this.state.patches[i]\n      if(patch)\n        this.loadPatch(patch)\n    }\n\n    if(prevState.patches.length !== this.state.patches.length){\n      this.setState({current:0})\n      const patch = this.state.patches[0]\n      if(patch)\n        this.loadPatch(patch)\n    }\n  }\n\n  loadPatch(patch) {\n    this.context.updateParams(patch.params,true)\n  }\n\n\n  addDmpPatch = (name, d) => {\n    const patch = dmp2patch(name,d)\n    if(patch !== null){\n      //is there any risk here?\n      const patches = this.state.patches\n      patches.push(patch)\n      this.save(patches)\n    }\n  }\n\n  onChangeHandler = (ev) => {\n    for(const f of ev.target.files){\n      const fr = new FileReader()\n      fr.onload = () =>{\n        const d = new Int8Array(fr.result)\n        this.addDmpPatch(f.name,d)\n      }\n      fr.readAsArrayBuffer(f)\n    }\n  }\n\n  onChange = (ev) => {\n    this.setState({current: ev.target.value})\n    ev.target.blur()\n  }\n\n  onSave = (e) => {\n    e.preventDefault()\n    if(this.state.patches.length===0)\n      return\n\n    const patches = this.state.patches\n    const i = parseInt(this.state.current)\n    patches[i].params = this.context.params\n    this.save(patches)\n\n  }\n\n  onCreate = (e) => {\n    e.preventDefault()\n    let patch = prompt(\"Name your patch\")\n    if (patch !== null && patch !== \"\") {\n      const patches = this.state.patches\n      patches.push({name:patch, params: this.context.params})\n      this.save(patches)\n    }\n  }\n\n  onDelete = (e) => {\n    e.preventDefault()\n    if(this.state.patches.length<=1)\n      return\n\n    const patches = this.state.patches.filter( (p,i) => i!==parseInt(this.state.current))\n    this.save(patches)\n  }\n\n  onLoadDefaults = (e) => {\n    e.preventDefault()\n    this.loadDefaultPatches()\n  }\n\n  onLeftClick = (e) => {\n    e.preventDefault()\n    const i = parseInt(this.state.current)\n    if(i>0){\n      this.setState({current:i-1})\n    }\n  }\n\n  onRightClick = (e) => {\n    e.preventDefault()\n    const i = parseInt(this.state.current)\n    if(i<this.state.patches.length-1){\n      this.setState({current:i+1})\n    }\n  }\n\n  onUploadClick = (e) => {\n    e.preventDefault()\n    this.refs.file.click()\n  }\n\n  render() {\n    return (\n      <nav>\n        <a href=\"/\" title=\"Previous Patch\" onClick={this.onLeftClick}><FaCaretLeft/></a>\n        <select value={this.state.current} onChange={this.onChange}>\n          {this.state.patches.map((p,i) =><option key={i} value={i}>{p.name}</option>)}\n        </select>\n        <a href=\"/\" title=\"Next Patch\" onClick={this.onRightClick}><FaCaretRight/></a>\n        <a href=\"/\" title=\"Save this Patch\" onClick={this.onSave}><FaSave/></a>\n        <a href=\"/\" title=\"Create new Patch\" onClick={this.onCreate}><FaPlus/></a>\n        <a href=\"/\" title=\"Upload Patches\" onClick={this.onUploadClick}><FaUpload/></a>\n        <a href=\"/\" title=\"Delete this Patch\" onClick={this.onDelete}><FaBackspace/></a>\n        <a href=\"/\" title=\"Load default Patches\" onClick={this.onLoadDefaults}><FaBomb/></a>\n        <input style={{display:'none'}} ref=\"file\" type=\"file\" accept=\".dmp\" multiple onChange={this.onChangeHandler} / >\n\n      </nav>\n    )\n  }\n}\n\n\nexport default Patches;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\n\nclass Envelope extends React.Component {\n  static contextType = CV2612Context\n  constructor(props) {\n    super(props)\n    this.state = {}\n    this.code = `${props.ch}_${props.op}`\n  }\n\n  render() {\n    return (\n      <div className=\"envelope\">\n        <svg height=\"100\" width=\"400\" viewBox=\"0 0 400 100\" xmlns=\"http://www.w3.org/2000/svg\">\n          <polyline points={this.context.envelopes[this.code]} />\n        </svg>\n      </div>\n    )\n  }\n}\n\nEnvelope.defaultProps = {\n  ch: 6,\n  op: 4\n};\n\n\nexport default Envelope;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport {bitness} from \"./utils/patches-utils\"\n\nclass Slider extends React.Component {\n  static contextType = CV2612Context\n  constructor(props) {\n    super(props)\n    this.code = `${props.ch}_${props.op}_${props.name}`\n    const bits = bitness(this.code)\n    this.max = Math.pow(2,bits)-1\n    this.state = {}\n  }\n\n  onChange = (ev) =>{\n    ev.preventDefault()\n    this.context.updateParam(this.code,parseInt(ev.target.value))\n    this.context.setActiveParameter(this.code)\n  }\n\n  onClick = (ev) =>{\n    ev.preventDefault()\n    this.context.setActiveParameter(this.code)\n  }\n\n  render() {\n    const m = this.context.mapping[this.code]\n    const mapped = ( (m.ch && m.cc)!==null)\n    let className = 'slider'\n    if(this.context.learning) className += ' learn'\n    if(this.context.activeParameter === this.code) className += ' active'\n    if(mapped) className += ' mapped'\n\n    return (\n      <div className={className} onClick={this.onClick} code={this.code}>\n        <label>{this.props.name}</label>\n        <input type=\"range\" step={1} min={0} max={this.max} value={this.context.params[this.code]}\n         onChange={this.onChange} />\n        <span>\n          {this.context.params[this.code] + (this.context.learning ? (mapped ? ` - ${m.ch}:${m.cc}` : ' - n/a'): '') }\n        </span>\n      </div>\n    )\n  }\n}\n\nSlider.defaultProps = {\n  env: false,\n  ch: 6,\n  op: 4\n}\n\nexport default Slider\n","import React from 'react'\nimport Envelope from \"./envelope\"\nimport Slider from \"./slider\"\nimport {CV2612Context} from \"./context\"\n\nclass Operator extends React.Component {\n  static contextType = CV2612Context\n\n  render() {\n    return (\n      <div className=\"operator\">\n        <h5>Op {this.props.op===4? 'Omni': this.props.op+1}</h5>\n        <Slider name=\"ar\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"d1\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"sl\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"d2\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"rr\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"tl\" ch={this.props.ch} op={this.props.op} />\n        <Envelope ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"mul\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"det\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"rs\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"am\" ch={this.props.ch} op={this.props.op} />\n      </div>\n    )\n  }\n}\n\n\nOperator.defaultProps = {\n  ch: 6\n};\n\n\nexport default Operator;\n","import React from 'react'\nimport Operator from \"./operator\"\nimport Slider from \"./slider\"\nimport {CV2612Context} from \"./context\"\nimport algorithmAscii from \"./utils/algorithmAscii\"\n\nclass Channel extends React.Component {\n  static contextType = CV2612Context\n\n  render() {\n    return (\n      <div className=\"channel\">\n        <table>\n          <tbody>\n            <tr>\n              <td><Slider name=\"lfo\" /></td>\n              <td><Slider name=\"en\" /></td>\n              <td></td>\n              <td></td>\n              <td>\n                <pre className=\"algorithm\">\n                  {algorithmAscii(this.context.params[`${this.props.ch}_4_al`])}\n                </pre>\n              </td>\n            </tr>\n            <tr>\n              <td><Slider name=\"fb\"  ch={this.props.ch} /></td>\n              <td><Slider name=\"ams\" ch={this.props.ch} /></td>\n              <td><Slider name=\"fms\" ch={this.props.ch} /></td>\n              <td><Slider name=\"st\"  ch={this.props.ch} /></td>\n              <td><Slider name=\"al\" ch={this.props.ch} /></td>\n            </tr>\n            <tr>\n              <td><Operator ch={this.props.ch} op={4} /></td>\n              <td><Operator ch={this.props.ch} op={0} /></td>\n              <td><Operator ch={this.props.ch} op={1} /></td>\n              <td><Operator ch={this.props.ch} op={2} /></td>\n              <td><Operator ch={this.props.ch} op={3} /></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\n\nChannel.defaultProps = {\n  ch: 6\n}\n\nexport default Channel\n","export default function algorithmAscii(algorithm){\n  switch(algorithm) {\n    case 0:\n      return `\n\n\n\n╔═╗ ╔═╗ ╔═╗ ╔═╗\n║1╠═╣2╠═╣3╠═╣4╠══\n╚═╝ ╚═╝ ╚═╝ ╚═╝\n\n\n\n`\n    case 1:\n    return `\n\n╔═╗\n║1╠═╗\n╚═╝ ║  ╔═╗  ╔═╗\n    ╠══╣3╠══╣4╠══\n╔═╗ ║  ╚═╝  ╚═╝\n║2╠═╝\n╚═╝\n\n`\n    case 2:\n    return `\n\n     ╔═╗\n     ║1╠═╗\n     ╚═╝ ║  ╔═╗\n         ╠══╣4╠══\n╔═╗  ╔═╗ ║  ╚═╝\n║2╠══╣3╠═╝\n╚═╝  ╚═╝\n\n`\n    case 3:\n    return `\n\n╔═╗  ╔═╗\n║1╠══╣2╠═╗\n╚═╝  ╚═╝ ║  ╔═╗\n         ╠══╣4╠══\n     ╔═╗ ║  ╚═╝\n     ║3╠═╝\n     ╚═╝\n\n`\n    case 4:\n    return `\n\n╔═╗  ╔═╗\n║1╠══╣2╠═╗\n╚═╝  ╚═╝ ║\n         ╠══\n╔═╗  ╔═╗ ║\n║3╠══╣4╠═╝\n╚═╝  ╚═╝\n\n`\n    case 5:\n    return `\n      ╔═╗\n    ╔═╣2╠══╗\n    ║ ╚═╝  ║\n╔═╗ ║ ╔═╗  ║\n║1╠═╬═╣3╠══╬══\n╚═╝ ║ ╚═╝  ║\n    ║ ╔═╗  ║\n    ╚═╣4╠══╝\n      ╚═╝\n`\n    case 6:\n    return `\n ╔═╗  ╔═╗\n ║1╠══╣2╠══╗\n ╚═╝  ╚═╝  ║\n      ╔═╗  ║\n      ║3╠══╬══\n      ╚═╝  ║\n      ╔═╗  ║\n      ║4╠══╝\n      ╚═╝\n`\n    case 7:\n    return `\n\n\n╔═╗ ╔═╗ ╔═╗ ╔═╗\n║1║ ║2║ ║3║ ║4║\n╚╦╝ ╚╦╝ ╚╦╝ ╚╦╝\n ╚═══╩═╦═╩═══╝\n       ║\n       ╚══\n\n`\n  default:\n      return 'no algorithm'\n  }\n}\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport Channel from \"./channel\"\n\nclass Channels extends React.Component {\n  static contextType = CV2612Context\n\n  onFilterChannel= (ev) => {\n    ev.preventDefault()\n    const ch = parseInt(ev.target.attributes.ch.value)\n    this.context.filterChannel(ch)\n  }\n\n  render() {\n    const f = this.context.filters\n    return (\n        <>\n          <nav>\n            {[6,0,1,2,3,4,5].map(i => <a href=\"/\" className={f.ch === i ? 'active':'' } key={i} ch={i} onClick={this.onFilterChannel} title={i === 6 ? 'Show only Omni channel':`Show only channel ${i+1}` }>{i === 6 ? 'Omni channel':`${i+1}` }</a>)}\n          </nav>\n          {[0,1,2,3,4,5,6].map(i => (f.ch === i) && <Channel key={i} ch={i} />)}\n        </>\n    )\n  }\n\n}\n\nexport default Channels\n","\nimport React from \"react\"\nimport CV2612Provider from \"./context\"\nimport Midi from \"./midi\"\nimport Emulator from './emulator'\nimport Sequencer from \"./sequencer\"\nimport Patches from \"./patches\"\nimport Channels from \"./channels\"\n\nclass Device extends React.Component {\n\n  render() {\n    return (\n        <CV2612Provider>\n          <Emulator />\n          <Midi />\n          <Sequencer />\n          <Patches />\n          <Channels />\n        </CV2612Provider>\n    )\n  }\n}\n\nexport default Device\n","import React from \"react\"\nimport Layout from \"../../layouts/cv2612\"\nimport SEO from \"../../components/seo\"\nimport Device from \"../../components/cv2612/device\"\n\n\nclass CV2612Index extends React.Component {\n  render() {\n    return (\n      <Layout location={this.props.location} >\n        <SEO title=\"cv2612\" />\n        <Device />\n      </Layout>\n    )\n  }\n}\n\nexport default CV2612Index\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Link, {\n  withPrefix,\n  withAssetPrefix,\n  navigate,\n  push,\n  replace,\n  navigateTo,\n  parsePath,\n} from \"gatsby-link\"\nimport PageRenderer from \"./public-page-renderer\"\n\nconst StaticQueryContext = React.createContext({})\n\nconst StaticQuery = props => (\n  <StaticQueryContext.Consumer>\n    {staticQueryData => {\n      if (\n        props.data ||\n        (staticQueryData[props.query] && staticQueryData[props.query].data)\n      ) {\n        return (props.render || props.children)(\n          props.data ? props.data.data : staticQueryData[props.query].data\n        )\n      } else {\n        return <div>Loading (StaticQuery)</div>\n      }\n    }}\n  </StaticQueryContext.Consumer>\n)\n\nconst useStaticQuery = query => {\n  if (\n    typeof React.useContext !== `function` &&\n    process.env.NODE_ENV === `development`\n  ) {\n    throw new Error(\n      `You're likely using a version of React that doesn't support Hooks\\n` +\n        `Please update React and ReactDOM to 16.8.0 or later to use the useStaticQuery hook.`\n    )\n  }\n  const context = React.useContext(StaticQueryContext)\n  if (context[query] && context[query].data) {\n    return context[query].data\n  } else {\n    throw new Error(\n      `The result of this StaticQuery could not be fetched.\\n\\n` +\n        `This is likely a bug in Gatsby and if refreshing the page does not fix it, ` +\n        `please open an issue in https://github.com/gatsbyjs/gatsby/issues`\n    )\n  }\n}\n\nStaticQuery.propTypes = {\n  data: PropTypes.object,\n  query: PropTypes.string.isRequired,\n  render: PropTypes.func,\n  children: PropTypes.func,\n}\n\nfunction graphql() {\n  throw new Error(\n    `It appears like Gatsby is misconfigured. Gatsby related \\`graphql\\` calls ` +\n      `are supposed to only be evaluated at compile time, and then compiled away. ` +\n      `Unfortunately, something went wrong and the query was left in the compiled code.\\n\\n` +\n      `Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.`\n  )\n}\n\nexport {\n  Link,\n  withAssetPrefix,\n  withPrefix,\n  graphql,\n  parsePath,\n  navigate,\n  push, // TODO replace for v3\n  replace, // TODO remove replace for v3\n  navigateTo, // TODO: remove navigateTo for v3\n  StaticQueryContext,\n  StaticQuery,\n  PageRenderer,\n  useStaticQuery,\n}\n","const preferDefault = m => (m && m.default) || m\n\nif (process.env.BUILD_STAGE === `develop`) {\n  module.exports = preferDefault(require(`./public-page-renderer-dev`))\n} else if (process.env.BUILD_STAGE === `build-javascript`) {\n  module.exports = preferDefault(require(`./public-page-renderer-prod`))\n} else {\n  module.exports = () => null\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Helmet from \"react-helmet\"\nimport { StaticQuery, graphql } from \"gatsby\"\n\nfunction SEO({ description, lang, meta, keywords, title }) {\n  return (\n    <StaticQuery\n      query={detailsQuery}\n      render={data => {\n        const metaDescription =\n          description || data.site.siteMetadata.description\n        return (\n          <Helmet\n            htmlAttributes={{\n              lang,\n            }}\n            title={title}\n            titleTemplate={`%s | ${data.site.siteMetadata.title}`}\n            meta={[\n              {\n                name: `description`,\n                content: metaDescription,\n              },\n              {\n                property: `og:title`,\n                content: title,\n              },\n              {\n                property: `og:description`,\n                content: metaDescription,\n              },\n              {\n                property: `og:type`,\n                content: `website`,\n              },\n              {\n                name: `twitter:card`,\n                content: `summary`,\n              },\n              {\n                name: `twitter:creator`,\n                content: data.site.siteMetadata.author,\n              },\n              {\n                name: `twitter:title`,\n                content: title,\n              },\n              {\n                name: `twitter:description`,\n                content: metaDescription,\n              },\n            ]\n              .concat(\n                keywords.length > 0\n                  ? {\n                      name: `keywords`,\n                      content: keywords.join(`, `),\n                    }\n                  : []\n              )\n              .concat(meta)}\n          />\n        )\n      }}\n    />\n  )\n}\n\nSEO.defaultProps = {\n  lang: `en`,\n  meta: [],\n  keywords: [],\n}\n\nSEO.propTypes = {\n  description: PropTypes.string,\n  lang: PropTypes.string,\n  meta: PropTypes.array,\n  keywords: PropTypes.arrayOf(PropTypes.string),\n  title: PropTypes.string.isRequired,\n}\n\nexport default SEO\n\nconst detailsQuery = graphql`\n  query DefaultSEOQuery {\n    site {\n      siteMetadata {\n        title\n        description\n        author\n      }\n    }\n  }\n`\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport InternalPageRenderer from \"./page-renderer\"\nimport loader from \"./loader\"\n\nconst ProdPageRenderer = ({ location }) => {\n  const pageResources = loader.getResourcesForPathnameSync(location.pathname)\n  if (!pageResources) {\n    return null\n  }\n\n  return React.createElement(InternalPageRenderer, {\n    location,\n    pageResources,\n    ...pageResources.json,\n  })\n}\n\nProdPageRenderer.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default ProdPageRenderer\n","import React from \"react\"\nimport { Link } from \"gatsby\"\nimport PropTypes from 'prop-types'\n\nconst swaps = [['i','1'],['e','3'],['o','0'],['g','6'],['a','4']]\n//todo: improve performance\nclass Brand extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.state = {title: props.title, swaps: props.swaps || swaps}\n  }\n\n  getDiff(){\n    let diff = 0\n    for(let i=0;i<this.props.title.length;i++){\n      diff += (this.state.title[i]===this.props.title[i]) ? 0 : 1\n    }\n    return diff\n  }\n\n  timer() {\n    const swaps = this.state.swaps\n    let i = Math.floor(Math.random()*swaps.length)\n    let from = Math.round(Math.random())\n    if(this.getDiff()>3) from = 1\n    let to = from ? 0 : 1\n    if(Math.random()<0.5){\n      this.setState({\n        title: this.state.title.replace(swaps[i][from],swaps[i][to])\n      })\n    }\n  }\n\n  componentDidMount(){\n    this.intervalId = setInterval(this.timer.bind(this), 100);\n  }\n\n  componentWillUnmount(){\n    clearInterval(this.intervalId);\n  }\n\n  render() {\n    return (\n        <h1>\n          <Link to={`/`}>{this.state.title}</Link>\n        </h1>\n    )\n  }\n\n}\n\n\n\nBrand.propTypes = {\n  title: PropTypes.string.isRequired,\n  swaps: PropTypes.array,\n};\n\n\nexport default Brand\n"],"sourceRoot":""}